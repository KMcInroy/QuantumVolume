(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    253383,       6112]
NotebookOptionsPosition[    248541,       6035]
NotebookOutlinePosition[    249022,       6053]
CellTagsIndexPosition[    248979,       6050]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"QuEST", " ", "VQD", " ", "Setup"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
   "Import", "[", "\"\<https://qtechtheory.org/questlink.m\>\"", "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CreateDownloadedQuESTEnv", "[", "]"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.9035017448713903`*^9, 3.9035017650130672`*^9}, 
   3.90532649547536*^9},
 CellLabel->
  "In[560]:=",ExpressionUUID->"d855bdca-4d56-40ea-ba6d-4b252baa9a80"],

Cell[BoxData[
 TemplateBox[{
  "URLDownload", "invhttp", 
   "\"\\!\\(\\*RowBox[{\\\"\\\\\\\"Failed writing body (0 != 16384)\\\\\\\"\\\
\"}]\\).\"", 2, 561, 241, 21860084295581428627, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.905507577065618*^9, 3.9055102853211555`*^9, 
  3.9055103705444407`*^9},
 CellLabel->
  "During evaluation of \
In[560]:=",ExpressionUUID->"7f629585-a68e-4c55-905e-4bd8e874869b"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Get", "[", 
  "\"\<C:\\\\Users\\\\KitKa\\\\QuantumVolume\\\\QuESTCheck\\\\vqd CG V3 \
Parallel.wl\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.9035017448713903`*^9, 3.9035017650130672`*^9}, 
   3.90532649547536*^9},
 EmphasizeSyntaxErrors->True,
 CellLabel->
  "In[562]:=",ExpressionUUID->"6e9f0a85-272e-40a5-b8b8-a870c25583b0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{
   "Import", "[", 
    "\"\<C:\\\\Users\\\\KitKa\\\\QuantumVolume\\\\QuESTCheck\\\\\
SU4Gates9Qubits.csv\>\"", "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[563]:=",ExpressionUUID->"5027551a-3088-4742-a531-8d292fa4f707"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"distloc", "[", 
     RowBox[{"q1_", ",", " ", "q2_"}], "]"}], " ", ":=", " ", "\n", "\t\t\t", 
    RowBox[{
     RowBox[{"Norm", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"RydDev", "[", "AtomLocations", "]"}], "[", "q1", "]"}], " ",
         "-", " ", 
        RowBox[{
         RowBox[{"RydDev", "[", "AtomLocations", "]"}], "[", "q2", "]"}]}], 
       ",", " ", "2"}], "]"}], " ", 
     RowBox[{"RydDev", "[", "UnitLattice", "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"blockadecheck", "[", "q_List", "]"}], " ", ":=", " ", "\n", 
   "\t\t\t", 
   RowBox[{"And", " ", "@@", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"distloc", " ", "@@", " ", "#"}], " ", "<=", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"RydDev", "[", "BlockadeRadius", "]"}], "+", 
           "$MachineEpsilon"}], ")"}]}], ")"}], "&"}], " ", "/@", " ", 
      RowBox[{"Subsets", "[", 
       RowBox[{
        RowBox[{"Flatten", "[", "q", "]"}], ",", " ", 
        RowBox[{"{", "2", "}"}]}], "]"}]}], ")"}]}]}], ";"}]}], "Input",
 CellLabel->
  "In[564]:=",ExpressionUUID->"49b247da-0332-4103-8a0e-d3bf988c86fa"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"VQD", " ", "Initialisation"}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"locations", "=", 
     RowBox[{"Association", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"#1", "->", "#2"}], "&"}], "@@@", 
       RowBox[{"Transpose", "@", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Range", "[", 
           RowBox[{"0", ",", "8"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "1", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "2", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "2", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"2", ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"2", ",", "1", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"2", ",", "2", ",", "0"}], "}"}]}], "}"}]}], "}"}]}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SWAPlocations", "=", 
     RowBox[{"Association", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"#1", "->", "#2"}], "&"}], "@@@", 
       RowBox[{"Transpose", "@", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Range", "[", 
           RowBox[{"0", ",", "8"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "1", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"2", ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"2", ",", "1", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"3", ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"3", ",", "1", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"4", ",", "0", ",", "0"}], "}"}]}], "}"}]}], "}"}]}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ParallelConfig", "=", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"The", " ", "total", " ", "number", " ", "of", " ", 
        RowBox[{"atoms", "/", "qubit"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"QubitNum", " ", "\[Rule]", "  ", "9"}], "\[IndentingNewLine]",
        ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "Physical", " ", "location", " ", "on", " ", "each", " ", "qubit", 
          " ", "described", " ", "with", " ", "a", " ", "2", "D"}], "-", " ", 
         RowBox[{"or", " ", "3", "D"}], "-", "vector"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"AtomLocations", " ", "\[Rule]", " ", "SWAPlocations"}], 
       "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"It", "'"}], "s", " ", "presumed", " ", "that", " ", 
         SuperscriptBox[
          SubscriptBox["T", "2"], "*"], " ", "has", " ", "been", " ", 
         "echoed", " ", "out", " ", "to", " ", 
         SubscriptBox["T", "2"]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"T2", " ", "\[Rule]", " ", 
        RowBox[{"1.49", "*", 
         SuperscriptBox["10", "6"]}]}], "\[IndentingNewLine]", ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "The", " ", "life", " ", "time", " ", "of", " ", "vacuum", " ", 
          "chamber"}], ",", " ", 
         RowBox[{
          RowBox[{
          "where", " ", "it", " ", "affects", " ", "the", " ", "coherence", 
           " ", 
           RowBox[{"time", ":", " ", "T1"}]}], "=", 
          RowBox[{"\[Tau]vac", "/", "N"}]}]}], "  ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"VacLifeTime", " ", "\[Rule]", " ", 
        RowBox[{"4", "*", 
         SuperscriptBox["10", "6"]}]}], "\[IndentingNewLine]", ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"Rabi", " ", "frequency", " ", "of", " ", "the", " ", 
          RowBox[{"atoms", ".", " ", "We"}], " ", "assume", " ", "the", " ", 
          "duration", " ", "of", " ", "multi"}], "-", 
         RowBox[{
         "qubit", " ", "gates", " ", "is", " ", "as", " ", "long", " ", "as", 
          " ", "4", "\[Pi]", " ", "pulse", " ", "of", " ", "single"}], "-", 
         RowBox[{"qubit", " ", "gates"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"RabiFreq", " ", "\[Rule]", " ", "1"}], "\[IndentingNewLine]", 
       ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"Asymmetric", " ", "bit"}], "-", 
          RowBox[{"flip", " ", "error", " ", "probability"}]}], ";", " ", 
         RowBox[{
         "the", " ", "error", " ", "is", " ", "acquired", " ", "during", " ", 
          "single", " ", "qubit", " ", "operation"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"ProbBFRot", " ", "->", " ", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"10", "->", "0"}], ",", " ", 
          RowBox[{"01", "->", "0"}]}], "|>"}]}], "\[IndentingNewLine]", ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Unit", " ", "lattice", " ", "in", " ", 
         RowBox[{"\[Mu]m", ".", " ", "This"}], " ", "will", " ", "be", " ", 
         "the", " ", "unit", " ", "the", " ", "lattice", " ", "and", " ", 
         "coordinates"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"UnitLattice", " ", "\[Rule]", " ", "1"}], 
       "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "blockade", " ", "radius", " ", "of", " ", "each", " ", "atom"}], " ",
         "*)"}], "\[IndentingNewLine]", 
       RowBox[{"BlockadeRadius", " ", "\[Rule]", " ", "10"}], 
       "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "The", " ", "factor", " ", "that", " ", "estimates", " ", 
          "accelerated", " ", "dephasing", " ", "due", " ", "to", " ", 
          "moving", " ", "the", " ", 
          RowBox[{"atoms", ".", " ", "Ideally"}]}], ",", " ", 
         RowBox[{
         "it", " ", "is", " ", "calculated", " ", "from", " ", "the", " ", 
          "distance", " ", "and", " ", 
          RowBox[{"speed", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"HeatFactor", " ", "->", " ", "0"}], "\[IndentingNewLine]", 
       ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Leakage", " ", "probability", " ", "during", " ", "initalisation", 
         " ", "process"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"ProbLeakInit", " ", "\[Rule]", " ", "0.003"}], 
       RowBox[{"(*", "0.007", "*)"}], "\[IndentingNewLine]", ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"duration", " ", "of", " ", "moving", " ", "atoms"}], ";", 
         " ", 
         RowBox[{
         "we", " ", "assume", " ", "SWAPLoc", " ", "and", " ", "ShiftLoc", 
          " ", "take", " ", "this", " ", "amount", " ", "of", " ", 
          RowBox[{"time", ":", " ", 
           RowBox[{"100", " ", "\[Mu]s"}]}]}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"DurMove", " ", "->", " ", "100"}], "\[IndentingNewLine]", ",",
        "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "duration", " ", "of", " ", "lattice", " ", "initialization", " ", 
         "which", " ", "involves", " ", "the", " ", "atom", " ", "loading", 
         " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"~", "50"}], "%"}], ")"}], " ", "and", " ", "rearranging", 
         " ", "the", " ", "optical", " ", "tweezer"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"DurInit", " ", "\[Rule]", " ", "300"}], "\[IndentingNewLine]",
        ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "measurement", " ", "fidelity", " ", "and", " ", "duration"}], ",", 
         " ", 
         RowBox[{
         "were", " ", "it", " ", "induces", " ", "atom", " ", "loss", " ", 
          "afterward"}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"FidMeas", " ", "\[Rule]", " ", "100"}], "\[IndentingNewLine]",
        ",", "\[IndentingNewLine]", 
       RowBox[{"DurMeas", " ", "\[Rule]", " ", 
        RowBox[{"2", "*", 
         SuperscriptBox["10", "4"]}]}], "\[IndentingNewLine]", ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "The", " ", "increasing", " ", "probability", " ", "of", " ", "atom", 
         " ", "loss", " ", "on", " ", "each", " ", 
         RowBox[{"measurement", ".", " ", "The"}], " ", "value", " ", "keeps",
          " ", "increasing", " ", "until", " ", "being", " ", "initialised"}],
         " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"ProbLossMeas", " ", "\[Rule]", " ", "0"}], 
       "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "leak", " ", "probability", " ", "of", " ", "implementing", " ", 
          "multi"}], "-", 
         RowBox[{"qubit", " ", "gates"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"ProbLeakCZ", " ", "\[Rule]", " ", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"01", "\[Rule]", " ", "0.001"}], ",", 
          RowBox[{"11", "\[Rule]", "0.001"}]}], " ", "|>"}]}]}], 
      "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SWAPConfig", "=", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"The", " ", "total", " ", "number", " ", "of", " ", 
        RowBox[{"atoms", "/", "qubit"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"QubitNum", " ", "\[Rule]", "  ", "9"}], "\[IndentingNewLine]",
        ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "Physical", " ", "location", " ", "on", " ", "each", " ", "qubit", 
          " ", "described", " ", "with", " ", "a", " ", "2", "D"}], "-", " ", 
         RowBox[{"or", " ", "3", "D"}], "-", "vector"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"AtomLocations", " ", "\[Rule]", " ", "SWAPlocations"}], 
       "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"It", "'"}], "s", " ", "presumed", " ", "that", " ", 
         SuperscriptBox[
          SubscriptBox["T", "2"], "*"], " ", "has", " ", "been", " ", 
         "echoed", " ", "out", " ", "to", " ", 
         SubscriptBox["T", "2"]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"T2", " ", "\[Rule]", " ", 
        RowBox[{"1.49", "*", 
         SuperscriptBox["10", "6"]}]}], "\[IndentingNewLine]", ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "The", " ", "life", " ", "time", " ", "of", " ", "vacuum", " ", 
          "chamber"}], ",", " ", 
         RowBox[{
          RowBox[{
          "where", " ", "it", " ", "affects", " ", "the", " ", "coherence", 
           " ", 
           RowBox[{"time", ":", " ", "T1"}]}], "=", 
          RowBox[{"\[Tau]vac", "/", "N"}]}]}], "  ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"VacLifeTime", " ", "\[Rule]", " ", 
        RowBox[{"4", "*", 
         SuperscriptBox["10", "6"]}]}], "\[IndentingNewLine]", ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"Rabi", " ", "frequency", " ", "of", " ", "the", " ", 
          RowBox[{"atoms", ".", " ", "We"}], " ", "assume", " ", "the", " ", 
          "duration", " ", "of", " ", "multi"}], "-", 
         RowBox[{
         "qubit", " ", "gates", " ", "is", " ", "as", " ", "long", " ", "as", 
          " ", "4", "\[Pi]", " ", "pulse", " ", "of", " ", "single"}], "-", 
         RowBox[{"qubit", " ", "gates"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"RabiFreq", " ", "\[Rule]", " ", "1"}], "\[IndentingNewLine]", 
       ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"Asymmetric", " ", "bit"}], "-", 
          RowBox[{"flip", " ", "error", " ", "probability"}]}], ";", " ", 
         RowBox[{
         "the", " ", "error", " ", "is", " ", "acquired", " ", "during", " ", 
          "single", " ", "qubit", " ", "operation"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"ProbBFRot", " ", "->", " ", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"10", "->", "0"}], ",", " ", 
          RowBox[{"01", "->", "0"}]}], "|>"}]}], "\[IndentingNewLine]", ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Unit", " ", "lattice", " ", "in", " ", 
         RowBox[{"\[Mu]m", ".", " ", "This"}], " ", "will", " ", "be", " ", 
         "the", " ", "unit", " ", "the", " ", "lattice", " ", "and", " ", 
         "coordinates"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"UnitLattice", " ", "\[Rule]", " ", "1"}], 
       "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "blockade", " ", "radius", " ", "of", " ", "each", " ", "atom"}], " ",
         "*)"}], "\[IndentingNewLine]", 
       RowBox[{"BlockadeRadius", " ", "\[Rule]", " ", "1.1"}], 
       "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "The", " ", "factor", " ", "that", " ", "estimates", " ", 
          "accelerated", " ", "dephasing", " ", "due", " ", "to", " ", 
          "moving", " ", "the", " ", 
          RowBox[{"atoms", ".", " ", "Ideally"}]}], ",", " ", 
         RowBox[{
         "it", " ", "is", " ", "calculated", " ", "from", " ", "the", " ", 
          "distance", " ", "and", " ", 
          RowBox[{"speed", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"HeatFactor", " ", "->", " ", "0"}], "\[IndentingNewLine]", 
       ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Leakage", " ", "probability", " ", "during", " ", "initalisation", 
         " ", "process"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"ProbLeakInit", " ", "\[Rule]", " ", "0.003"}], 
       RowBox[{"(*", "0.007", "*)"}], "\[IndentingNewLine]", ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"duration", " ", "of", " ", "moving", " ", "atoms"}], ";", 
         " ", 
         RowBox[{
         "we", " ", "assume", " ", "SWAPLoc", " ", "and", " ", "ShiftLoc", 
          " ", "take", " ", "this", " ", "amount", " ", "of", " ", 
          RowBox[{"time", ":", " ", 
           RowBox[{"100", " ", "\[Mu]s"}]}]}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"DurMove", " ", "->", " ", "0"}], "\[IndentingNewLine]", ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "duration", " ", "of", " ", "lattice", " ", "initialization", " ", 
         "which", " ", "involves", " ", "the", " ", "atom", " ", "loading", 
         " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"~", "50"}], "%"}], ")"}], " ", "and", " ", "rearranging", 
         " ", "the", " ", "optical", " ", "tweezer"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"DurInit", " ", "\[Rule]", " ", "300"}], "\[IndentingNewLine]",
        ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "measurement", " ", "fidelity", " ", "and", " ", "duration"}], ",", 
         " ", 
         RowBox[{
         "were", " ", "it", " ", "induces", " ", "atom", " ", "loss", " ", 
          "afterward"}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"FidMeas", " ", "\[Rule]", " ", "100"}], "\[IndentingNewLine]",
        ",", "\[IndentingNewLine]", 
       RowBox[{"DurMeas", " ", "\[Rule]", " ", 
        RowBox[{"2", "*", 
         SuperscriptBox["10", "4"]}]}], "\[IndentingNewLine]", ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "The", " ", "increasing", " ", "probability", " ", "of", " ", "atom", 
         " ", "loss", " ", "on", " ", "each", " ", 
         RowBox[{"measurement", ".", " ", "The"}], " ", "value", " ", "keeps",
          " ", "increasing", " ", "until", " ", "being", " ", "initialised"}],
         " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"ProbLossMeas", " ", "\[Rule]", " ", "0"}], 
       "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "leak", " ", "probability", " ", "of", " ", "implementing", " ", 
          "multi"}], "-", 
         RowBox[{"qubit", " ", "gates"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"ProbLeakCZ", " ", "\[Rule]", " ", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"01", "\[Rule]", " ", "0.001"}], ",", 
          RowBox[{"11", "\[Rule]", "0.001"}]}], " ", "|>"}]}]}], 
      "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"MoveTime", "=", "100"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Options", "[", "RydbergHub", "]"}], "=", "ParallelConfig"}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RydDev", "=", 
     RowBox[{"RydbergHub", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"PlotAtoms", "[", 
    RowBox[{"RydbergHub", "[", "]"}], "]"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.9049825037421207`*^9, 3.9049825713936133`*^9}, {
  3.905314393720093*^9, 3.9053144127923985`*^9}, {3.9053144523520546`*^9, 
  3.905314463984438*^9}, {3.9053144977905097`*^9, 3.9053145625913086`*^9}, {
  3.905318748688278*^9, 3.905318753454064*^9}, {3.905503769919512*^9, 
  3.9055039209157405`*^9}},
 CellLabel->
  "In[566]:=",ExpressionUUID->"3137d4a1-e69b-4fa3-ab75-76524c925fdc"],

Cell[BoxData["100"], "Output",
 CellChangeTimes->{{3.904982511993188*^9, 3.9049825720033665`*^9}, 
   3.9049830814740767`*^9, {3.9053145475974383`*^9, 3.9053145633469343`*^9}, 
   3.9053169098815565`*^9, 3.905318755544032*^9, 3.905319208794652*^9, 
   3.9053255284935937`*^9, 3.905329439419977*^9, 3.905481706563775*^9, 
   3.9055037300080953`*^9, {3.9055037729540496`*^9, 3.9055039221665697`*^9}, 
   3.905507580254591*^9, 3.905510288815608*^9, 3.90551037579786*^9},
 CellLabel->
  "Out[570]=",ExpressionUUID->"9877a295-5faf-48cd-80a1-e1c1621c6274"],

Cell[BoxData[
 Graphics3DBox[{Text3DBox[
    StyleBox["0",
     StripOnInput->False,
     LineColor->GrayLevel[1],
     FrontFaceColor->GrayLevel[1],
     BackFaceColor->GrayLevel[1],
     GraphicsColor->GrayLevel[1],
     FontWeight->Bold,
     FontColor->GrayLevel[1]], {0, 0, 0}], 
   {RGBColor[1, 0, 0], SphereBox[{0, 0, 0}, 0.15]}, Text3DBox[
    StyleBox["1",
     StripOnInput->False,
     LineColor->GrayLevel[1],
     FrontFaceColor->GrayLevel[1],
     BackFaceColor->GrayLevel[1],
     GraphicsColor->GrayLevel[1],
     FontWeight->Bold,
     FontColor->GrayLevel[1]], {0, 1, 0}], 
   {RGBColor[1, 0, 0], SphereBox[{0, 1, 0}, 0.15]}, Text3DBox[
    StyleBox["2",
     StripOnInput->False,
     LineColor->GrayLevel[1],
     FrontFaceColor->GrayLevel[1],
     BackFaceColor->GrayLevel[1],
     GraphicsColor->GrayLevel[1],
     FontWeight->Bold,
     FontColor->GrayLevel[1]], {1, 0, 0}], 
   {RGBColor[1, 0, 0], SphereBox[{1, 0, 0}, 0.15]}, Text3DBox[
    StyleBox["3",
     StripOnInput->False,
     LineColor->GrayLevel[1],
     FrontFaceColor->GrayLevel[1],
     BackFaceColor->GrayLevel[1],
     GraphicsColor->GrayLevel[1],
     FontWeight->Bold,
     FontColor->GrayLevel[1]], {1, 1, 0}], 
   {RGBColor[1, 0, 0], SphereBox[{1, 1, 0}, 0.15]}, Text3DBox[
    StyleBox["4",
     StripOnInput->False,
     LineColor->GrayLevel[1],
     FrontFaceColor->GrayLevel[1],
     BackFaceColor->GrayLevel[1],
     GraphicsColor->GrayLevel[1],
     FontWeight->Bold,
     FontColor->GrayLevel[1]], {2, 0, 0}], 
   {RGBColor[1, 0, 0], SphereBox[{2, 0, 0}, 0.15]}, Text3DBox[
    StyleBox["5",
     StripOnInput->False,
     LineColor->GrayLevel[1],
     FrontFaceColor->GrayLevel[1],
     BackFaceColor->GrayLevel[1],
     GraphicsColor->GrayLevel[1],
     FontWeight->Bold,
     FontColor->GrayLevel[1]], {2, 1, 0}], 
   {RGBColor[1, 0, 0], SphereBox[{2, 1, 0}, 0.15]}, Text3DBox[
    StyleBox["6",
     StripOnInput->False,
     LineColor->GrayLevel[1],
     FrontFaceColor->GrayLevel[1],
     BackFaceColor->GrayLevel[1],
     GraphicsColor->GrayLevel[1],
     FontWeight->Bold,
     FontColor->GrayLevel[1]], {3, 0, 0}], 
   {RGBColor[1, 0, 0], SphereBox[{3, 0, 0}, 0.15]}, Text3DBox[
    StyleBox["7",
     StripOnInput->False,
     LineColor->GrayLevel[1],
     FrontFaceColor->GrayLevel[1],
     BackFaceColor->GrayLevel[1],
     GraphicsColor->GrayLevel[1],
     FontWeight->Bold,
     FontColor->GrayLevel[1]], {3, 1, 0}], 
   {RGBColor[1, 0, 0], SphereBox[{3, 1, 0}, 0.15]}, Text3DBox[
    StyleBox["8",
     StripOnInput->False,
     LineColor->GrayLevel[1],
     FrontFaceColor->GrayLevel[1],
     BackFaceColor->GrayLevel[1],
     GraphicsColor->GrayLevel[1],
     FontWeight->Bold,
     FontColor->GrayLevel[1]], {4, 0, 0}], 
   {RGBColor[1, 0, 0], SphereBox[{4, 0, 0}, 0.15]}},
  Frame -> True,
  Axes->True,
  AxesLabel->{
    FormBox["\"x\"", TraditionalForm], 
    FormBox["\"y\"", TraditionalForm], 
    FormBox["\"z\"", TraditionalForm]},
  ImageSize->Medium]], "Output",
 CellChangeTimes->{{3.904982511993188*^9, 3.9049825720033665`*^9}, 
   3.9049830814740767`*^9, {3.9053145475974383`*^9, 3.9053145633469343`*^9}, 
   3.9053169098815565`*^9, 3.905318755544032*^9, 3.905319208794652*^9, 
   3.9053255284935937`*^9, 3.905329439419977*^9, 3.905481706563775*^9, 
   3.9055037300080953`*^9, {3.9055037729540496`*^9, 3.9055039221665697`*^9}, 
   3.905507580254591*^9, 3.905510288815608*^9, 3.9055103758068614`*^9},
 CellLabel->
  "Out[573]=",ExpressionUUID->"0f0bfcc0-bdf2-4c3b-85b5-cbf10afe6c90"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Algorithm", " ", "to", " ", "determine", " ", "the", " ", "necessary", 
    " ", "operations", " ", "for", " ", "any", " ", "two", " ", "qubits", " ",
     "to", " ", "share", " ", "connection"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "By", " ", "\"\<Rail\>\"", " ", "we", " ", "mean", " ", "they", " ", 
     "are", " ", "colinear", " ", "along", " ", "the", " ", "x"}], "-", 
    RowBox[{"axis", " ", "of", " ", "the", " ", "grid"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"SWAPSchedulePI", "[", 
     RowBox[{"GateData_", ",", "A_", ",", "B_", ",", "LocTrackerPI_"}], "]"}],
     ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"LocTracker", "=", "LocTrackerPI"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Same", " ", "Rail"}], "*)"}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"EvenQ", "[", 
          RowBox[{"Abs", "[", 
           RowBox[{
            RowBox[{"LocTracker", "[", 
             RowBox[{"[", 
              RowBox[{"A", "+", "1"}], "]"}], "]"}], "-", 
            RowBox[{"LocTracker", "[", 
             RowBox[{"[", 
              RowBox[{"B", "+", "1"}], "]"}], "]"}]}], "]"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Print", "[", "\"\<Same Rail\>\"", "]"}], ";"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"LocTracker", "[", 
              RowBox[{"[", 
               RowBox[{"A", "+", "1"}], "]"}], "]"}], "==", 
             RowBox[{
              RowBox[{"LocTracker", "[", 
               RowBox[{"[", 
                RowBox[{"B", "+", "1"}], "]"}], "]"}], "+", "2"}]}], "||", 
            RowBox[{
             RowBox[{"LocTracker", "[", 
              RowBox[{"[", 
               RowBox[{"A", "+", "1"}], "]"}], "]"}], "==", 
             RowBox[{
              RowBox[{"LocTracker", "[", 
               RowBox[{"[", 
                RowBox[{"B", "+", "1"}], "]"}], "]"}], "-", "2"}]}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"LocTracker", ",", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{"SU4GateDCPI", "[", 
                RowBox[{"GateData", ",", "A", ",", "B"}], "]"}], "}"}], 
              "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"MaxPosi", "=", 
             RowBox[{"Max", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"LocTracker", "[", 
                 RowBox[{"[", 
                  RowBox[{"A", "+", "1"}], "]"}], "]"}], ",", 
                RowBox[{"LocTracker", "[", 
                 RowBox[{"[", 
                  RowBox[{"B", "+", "1"}], "]"}], "]"}]}], "}"}], "]"}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"MinPosi", "=", 
             RowBox[{"Min", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"LocTracker", "[", 
                 RowBox[{"[", 
                  RowBox[{"A", "+", "1"}], "]"}], "]"}], ",", 
                RowBox[{"LocTracker", "[", 
                 RowBox[{"[", 
                  RowBox[{"B", "+", "1"}], "]"}], "]"}]}], "}"}], "]"}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"MaxPosQi", "=", 
             RowBox[{
              RowBox[{
               RowBox[{"Flatten", "[", 
                RowBox[{"Position", "[", 
                 RowBox[{"LocTracker", ",", "MaxPosi"}], "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], "-", "1"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"li", "=", 
             RowBox[{
              FractionBox[
               RowBox[{"(", 
                RowBox[{"MaxPosi", "-", "MinPosi"}], ")"}], "2"], "-", 
              "1"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{"\"\<m= \>\"", ",", "li"}], "]"}], ";"}], "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"OutputLayer", "=", 
             RowBox[{"Flatten", "[", 
              RowBox[{"Join", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Table", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"MaxPos", "=", 
                    RowBox[{"Max", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"LocTracker", "[", 
                    RowBox[{"[", 
                    RowBox[{"A", "+", "1"}], "]"}], "]"}], ",", 
                    RowBox[{"LocTracker", "[", 
                    RowBox[{"[", 
                    RowBox[{"B", "+", "1"}], "]"}], "]"}]}], "}"}], "]"}]}], 
                   ";", "\[IndentingNewLine]", 
                   RowBox[{"MaxPosQ", "=", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Position", "[", 
                    RowBox[{"LocTracker", ",", "MaxPos"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", "1"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"MinPos", "=", 
                    RowBox[{"Min", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"LocTracker", "[", 
                    RowBox[{"[", 
                    RowBox[{"A", "+", "1"}], "]"}], "]"}], ",", 
                    RowBox[{"LocTracker", "[", 
                    RowBox[{"[", 
                    RowBox[{"B", "+", "1"}], "]"}], "]"}]}], "}"}], "]"}]}], 
                   ";", "\[IndentingNewLine]", 
                   RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"Print", "[", 
                    RowBox[{
                    "\"\<MaxPos \>\"", ",", "MaxPos", ",", "\"\< MinPos \>\"",
                     ",", "MinPos", ",", " ", "\"\< MaxPosQ \>\"", ",", 
                    "MaxPosQ"}], " ", "]"}], ";"}], "*)"}], 
                   "\[IndentingNewLine]", 
                   RowBox[{"MoveTarg", "=", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Position", "[", 
                    RowBox[{"LocTracker", ",", 
                    RowBox[{"MaxPos", "-", "2"}]}], "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", "1"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"LocTracker", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Position", "[", 
                    RowBox[{"LocTracker", ",", 
                    RowBox[{"MaxPos", "-", "2"}]}], "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "+=", "2"}],
                    ";", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"LocTracker", "[", 
                    RowBox[{"[", 
                    RowBox[{"MaxPosQ", "+", "1"}], "]"}], "]"}], "-=", "2"}], 
                   ";", "\[IndentingNewLine]", 
                   RowBox[{"{", 
                    RowBox[{
                    SubscriptBox["SWAPDCPIRL", 
                    RowBox[{"MaxPosQi", ",", "MoveTarg"}]], ",", 
                    SubscriptBox["SWAPLoc", 
                    RowBox[{"MoveTarg", ",", "MaxPosQi"}]]}], "}"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", "1", ",", "li"}], "}"}]}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"SU4GateDCPI", "[", 
                  RowBox[{"GateData", ",", "A", ",", "B"}], "]"}], "}"}]}], 
               "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{"\"\<LocTracker\>\"", ",", "LocTracker"}], "]"}], 
              ";"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"LocTracker", ",", "OutputLayer"}], "}"}]}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Different", " ", "rail"}], ",", " ", 
           RowBox[{"A", " ", "is", " ", "the", " ", "top", " ", "rail"}]}], 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"OddQ", "[", 
          RowBox[{"LocTracker", "[", 
           RowBox[{"[", 
            RowBox[{"A", "+", "1"}], "]"}], "]"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Print", "[", "\"\<A odd, Diff Rail\>\"", "]"}], ";"}], 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"Which", "[", "\[IndentingNewLine]", 
          RowBox[{"(*", "Aligned", "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"LocTracker", "[", 
             RowBox[{"[", 
              RowBox[{"A", "+", "1"}], "]"}], "]"}], "==", 
            RowBox[{
             RowBox[{"LocTracker", "[", 
              RowBox[{"[", 
               RowBox[{"B", "+", "1"}], "]"}], "]"}], "+", "1"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"Print", "[", "\"\<Aligned\>\"", "]"}], ";"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"LocTracker", ",", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{"SU4GateDCPI", "[", 
                RowBox[{"GateData", ",", "A", ",", "B"}], "]"}], "}"}], 
              "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"A", " ", "Right", " ", "of", " ", "B"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"LocTracker", "[", 
             RowBox[{"[", 
              RowBox[{"A", "+", "1"}], "]"}], "]"}], ">", 
            RowBox[{"LocTracker", "[", 
             RowBox[{"[", 
              RowBox[{"B", "+", "1"}], "]"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"Print", "[", "\"\<A RHS B\>\"", "]"}], ";"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"m", "=", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"LocTracker", "[", 
                 RowBox[{"[", 
                  RowBox[{"A", "+", "1"}], "]"}], "]"}], "-", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"LocTracker", "[", 
                   RowBox[{"[", 
                    RowBox[{"B", "+", "1"}], "]"}], "]"}], "+", "1"}], 
                 ")"}]}], ")"}], "/", "2"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"OutputLayer", "=", 
             RowBox[{"Flatten", "[", 
              RowBox[{"Join", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Table", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"MoveTarg", "=", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Position", "[", 
                    RowBox[{"LocTracker", ",", 
                    RowBox[{
                    RowBox[{"LocTracker", "[", 
                    RowBox[{"[", 
                    RowBox[{"A", "+", "1"}], "]"}], "]"}], "-", "2"}]}], 
                    "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", "1"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"LocTracker", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Position", "[", 
                    RowBox[{"LocTracker", ",", 
                    RowBox[{
                    RowBox[{"LocTracker", "[", 
                    RowBox[{"[", 
                    RowBox[{"A", "+", "1"}], "]"}], "]"}], "-", "2"}]}], 
                    "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "+=", "2"}],
                    ";", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"LocTracker", "[", 
                    RowBox[{"[", 
                    RowBox[{"A", "+", "1"}], "]"}], "]"}], "-=", "2"}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"Print", "[", 
                    RowBox[{
                    "\"\<Desired SWAP: \>\"", " ", ",", "A", ",", " ", 
                    "\"\< -> \>\"", ",", " ", "MoveTarg"}], "]"}], ";"}], 
                    "*)"}], "\[IndentingNewLine]", 
                   RowBox[{"{", 
                    RowBox[{
                    SubscriptBox["SWAPDCPIRL", 
                    RowBox[{"MoveTarg", ",", "A"}]], ",", 
                    SubscriptBox["SWAPLoc", 
                    RowBox[{"MoveTarg", ",", "A"}]]}], "}"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", "1", ",", "m"}], "}"}]}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"SU4GateDCPI", "[", 
                  RowBox[{"GateData", ",", "A", ",", "B"}], "]"}], "}"}]}], 
               "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{"\"\<LocTracker\>\"", ",", "LocTracker"}], "]"}], 
              ";"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"LocTracker", ",", "OutputLayer"}], "}"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"A", " ", "left", " ", "of", " ", "B"}], "*)"}], 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"LocTracker", "[", 
             RowBox[{"[", 
              RowBox[{"A", "+", "1"}], "]"}], "]"}], "<", 
            RowBox[{"LocTracker", "[", 
             RowBox[{"[", 
              RowBox[{"B", "+", "1"}], "]"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"Print", "[", "\"\<A LHS B\>\"", "]"}], ";"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"m", "=", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"LocTracker", "[", 
                 RowBox[{"[", 
                  RowBox[{"B", "+", "1"}], "]"}], "]"}], "-", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"LocTracker", "[", 
                   RowBox[{"[", 
                    RowBox[{"A", "+", "1"}], "]"}], "]"}], "-", "1"}], 
                 ")"}]}], ")"}], "/", "2"}]}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"OutputLayer", "=", 
             RowBox[{"Flatten", "[", 
              RowBox[{"Join", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Table", "[", "\[IndentingNewLine]", 
                 RowBox[{"(*", 
                  RowBox[{
                   RowBox[{"Print", "[", 
                    RowBox[{
                    "\"\<LocTracker Before \>\"", ",", " ", "LocTracker"}], 
                    "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"MoveTarg", "=", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Position", "[", 
                    RowBox[{"LocTracker", ",", 
                    RowBox[{
                    RowBox[{"LocTracker", "[", 
                    RowBox[{"[", 
                    RowBox[{"B", "+", "1"}], "]"}], "]"}], "-", "2"}]}], 
                    "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", "1"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"LocTracker", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Position", "[", 
                    RowBox[{"LocTracker", ",", 
                    RowBox[{
                    RowBox[{"LocTracker", "[", 
                    RowBox[{"[", 
                    RowBox[{"B", "+", "1"}], "]"}], "]"}], "-", "2"}]}], 
                    "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "+=", "2"}],
                    ";", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"LocTracker", "[", 
                    RowBox[{"[", 
                    RowBox[{"B", "+", "1"}], "]"}], "]"}], "-=", "2"}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"Print", "[", 
                    RowBox[{
                    "\"\<Desired SWAP: \>\"", " ", ",", " ", "B", ",", " ", 
                    "\"\< -> \>\"", ",", " ", "MoveTarg"}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Print", "[", 
                    RowBox[{
                    "\"\<LocTracker After \>\"", ",", " ", "LocTracker"}], 
                    "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
                   RowBox[{"{", 
                    RowBox[{
                    SubscriptBox["SWAPDCPIRL", 
                    RowBox[{"MoveTarg", ",", "B"}]], ",", 
                    SubscriptBox["SWAPLoc", 
                    RowBox[{"MoveTarg", ",", "B"}]]}], "}"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", "1", ",", "m"}], "}"}]}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"SU4GateDCPI", "[", 
                  RowBox[{"GateData", ",", "A", ",", "B"}], "]"}], "}"}]}], 
               "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{"\"\<LocTracker\>\"", ",", "LocTracker"}], "]"}], 
              ";"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"LocTracker", ",", "OutputLayer"}], "}"}]}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Different", " ", "rail"}], ",", " ", 
           RowBox[{"B", " ", "is", " ", "the", " ", "top", " ", "rail"}]}], 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"OddQ", "[", 
          RowBox[{"LocTracker", "[", 
           RowBox[{"[", " ", 
            RowBox[{"B", "+", "1"}], "]"}], "]"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Print", "[", "\"\<Diff Rail, B top\>\"", "]"}], ";"}], 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"Which", "[", "\[IndentingNewLine]", 
          RowBox[{"(*", "Aligned", "*)"}], "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"LocTracker", "[", 
             RowBox[{"[", 
              RowBox[{"A", "+", "1"}], "]"}], "]"}], "==", 
            RowBox[{
             RowBox[{"LocTracker", "[", 
              RowBox[{"[", 
               RowBox[{"B", "+", "1"}], "]"}], "]"}], "-", "1"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"Print", "[", "\"\<Aligned\>\"", "]"}], ";"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"LocTracker", ",", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{"SU4GateDCPI", "[", 
                RowBox[{"GateData", ",", "A", ",", "B"}], "]"}], "}"}], 
              "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"A", " ", "right", " ", "of", " ", "B"}], "*)"}], 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"LocTracker", "[", 
             RowBox[{"[", 
              RowBox[{"A", "+", "1"}], "]"}], "]"}], ">", 
            RowBox[{"LocTracker", "[", 
             RowBox[{"[", 
              RowBox[{"B", "+", "1"}], "]"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"Print", "[", "\"\<A RHS B\>\"", "]"}], ";"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"m", "=", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"LocTracker", "[", 
                 RowBox[{"[", 
                  RowBox[{"A", "+", "1"}], "]"}], "]"}], "-", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"LocTracker", "[", 
                   RowBox[{"[", 
                    RowBox[{"B", "+", "1"}], "]"}], "]"}], "-", "1"}], 
                 ")"}]}], ")"}], "/", "2"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"OutputLayer", "=", 
             RowBox[{"Flatten", "[", 
              RowBox[{"Join", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Table", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"MoveTarg", "=", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Position", "[", 
                    RowBox[{"LocTracker", ",", 
                    RowBox[{
                    RowBox[{"LocTracker", "[", 
                    RowBox[{"[", 
                    RowBox[{"A", "+", "1"}], "]"}], "]"}], "-", "2"}]}], 
                    "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", "1"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"LocTracker", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Position", "[", 
                    RowBox[{"LocTracker", ",", 
                    RowBox[{
                    RowBox[{"LocTracker", "[", 
                    RowBox[{"[", 
                    RowBox[{"A", "+", "1"}], "]"}], "]"}], "-", "2"}]}], 
                    "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "+=", "2"}],
                    ";", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"LocTracker", "[", 
                    RowBox[{"[", 
                    RowBox[{"A", "+", "1"}], "]"}], "]"}], "-=", "2"}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"Print", "[", 
                    RowBox[{
                    "\"\<Desired SWAP: \>\"", " ", ",", " ", "A", ",", " ", 
                    "\"\< -> \>\"", ",", " ", "MoveTarg"}], "]"}], ";"}], 
                    "*)"}], "\[IndentingNewLine]", 
                   RowBox[{"{", 
                    RowBox[{
                    SubscriptBox["SWAPDCPIRL", 
                    RowBox[{"MoveTarg", ",", "A"}]], ",", 
                    SubscriptBox["SWAPLoc", 
                    RowBox[{"MoveTarg", ",", "A"}]]}], "}"}]}], ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", "1", ",", "m"}], "}"}]}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"SU4GateDCPI", "[", 
                  RowBox[{"GateData", ",", "A", ",", "B"}], "]"}], "}"}]}], 
               "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{"\"\<LocTracker\>\"", ",", "LocTracker"}], "]"}], 
              ";"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"LocTracker", ",", "OutputLayer"}], "}"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"A", " ", "Left", " ", "of", " ", "B"}], "*)"}], 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"LocTracker", "[", 
             RowBox[{"[", 
              RowBox[{"A", "+", "1"}], "]"}], "]"}], "<", 
            RowBox[{"LocTracker", "[", 
             RowBox[{"[", 
              RowBox[{"B", "+", "1"}], "]"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"Print", "[", "\"\<A LHS B\>\"", "]"}], ";"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"m", "=", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"LocTracker", "[", 
                 RowBox[{"[", 
                  RowBox[{"B", "+", "1"}], "]"}], "]"}], "-", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"LocTracker", "[", 
                   RowBox[{"[", 
                    RowBox[{"A", "+", "1"}], "]"}], "]"}], "+", "1"}], 
                 ")"}]}], ")"}], "/", "2"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"OutputLayer", "=", 
             RowBox[{"Flatten", "[", 
              RowBox[{"Join", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Table", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"MoveTarg", "=", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Position", "[", 
                    RowBox[{"LocTracker", ",", 
                    RowBox[{
                    RowBox[{"LocTracker", "[", 
                    RowBox[{"[", 
                    RowBox[{"B", "+", "1"}], "]"}], "]"}], "-", "2"}]}], 
                    "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", "1"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"LocTracker", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Position", "[", 
                    RowBox[{"LocTracker", ",", 
                    RowBox[{
                    RowBox[{"LocTracker", "[", 
                    RowBox[{"[", 
                    RowBox[{"B", "+", "1"}], "]"}], "]"}], "-", "2"}]}], 
                    "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "+=", "2"}],
                    ";", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"LocTracker", "[", 
                    RowBox[{"[", 
                    RowBox[{"B", "+", "1"}], "]"}], "]"}], "-=", "2"}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"Print", "[", 
                    RowBox[{
                    "\"\<Desired SWAP: \>\"", " ", ",", "B", " ", ",", " ", 
                    "\"\< -> \>\"", ",", " ", "MoveTarg"}], "]"}], ";"}], 
                    "*)"}], "\[IndentingNewLine]", 
                   RowBox[{"{", 
                    RowBox[{
                    SubscriptBox["SWAPDCPIRL", 
                    RowBox[{"MoveTarg", ",", "B"}]], ",", 
                    SubscriptBox["SWAPLoc", 
                    RowBox[{"MoveTarg", ",", "B"}]]}], "}"}]}], ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", "1", ",", "m"}], "}"}]}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"SU4GateDCPI", "[", 
                  RowBox[{"GateData", ",", "A", ",", "B"}], "]"}], "}"}]}], 
               "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{"\"\<LocTracker\>\"", ",", "LocTracker"}], "]"}], 
              ";"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"LocTracker", ",", "OutputLayer"}], "}"}]}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
     "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.903683581827444*^9, 3.903683661570174*^9}, {
   3.9036849513578515`*^9, 3.903685008740176*^9}, {3.903685213229289*^9, 
   3.9036852152012677`*^9}, {3.903685397990676*^9, 3.9036854564536047`*^9}, {
   3.9036855720195303`*^9, 3.9036856851909246`*^9}, {3.9036857187780027`*^9, 
   3.903685893296935*^9}, {3.9036865613996553`*^9, 3.903686591852091*^9}, {
   3.903686706792243*^9, 3.9036867984428167`*^9}, {3.9036871850235023`*^9, 
   3.9036871971851625`*^9}, {3.9036872552232385`*^9, 3.903687300939558*^9}, {
   3.9036873460410595`*^9, 3.9036874018665447`*^9}, {3.903687974899458*^9, 
   3.9036880803485117`*^9}, {3.903688117334236*^9, 3.9036881875007143`*^9}, {
   3.9036883082988625`*^9, 3.9036883202114716`*^9}, {3.9036883738189116`*^9, 
   3.903688423084288*^9}, {3.9036884666080055`*^9, 3.9036885023968506`*^9}, {
   3.9037061929192133`*^9, 3.9037061968029222`*^9}, {3.903706243744048*^9, 
   3.903706495070391*^9}, {3.9037065736139107`*^9, 3.9037066388083143`*^9}, {
   3.9037067038935585`*^9, 3.903706708123207*^9}, {3.903706819418605*^9, 
   3.903706877506047*^9}, 3.903706911737507*^9, {3.9037069518507175`*^9, 
   3.9037070650888896`*^9}, {3.9037071183146963`*^9, 
   3.9037071701937375`*^9}, {3.903707499758134*^9, 3.9037075227089596`*^9}, {
   3.9037075759861794`*^9, 3.903707583538072*^9}, {3.9037076779161615`*^9, 
   3.9037077105865173`*^9}, {3.9037077528064904`*^9, 3.903707762843733*^9}, {
   3.9037081133060293`*^9, 3.9037081515503454`*^9}, {3.9037082013635397`*^9, 
   3.903708297373401*^9}, {3.90370833953854*^9, 3.9037084635432158`*^9}, {
   3.903708515679747*^9, 3.9037085184183116`*^9}, {3.90370875281472*^9, 
   3.903708762303285*^9}, {3.903708843219326*^9, 3.9037088822477837`*^9}, {
   3.9037636303675585`*^9, 3.903763731382065*^9}, {3.903764818730709*^9, 
   3.9037648577092047`*^9}, {3.903764917110896*^9, 3.903764931177369*^9}, {
   3.903765457299114*^9, 3.903765517993867*^9}, {3.9037657023829165`*^9, 
   3.903765709697131*^9}, {3.9037662802799177`*^9, 3.9037663020847397`*^9}, {
   3.9037670096517572`*^9, 3.9037670420513287`*^9}, {3.903767877880329*^9, 
   3.9037679286926937`*^9}, {3.90376795982672*^9, 3.903767968397916*^9}, {
   3.9037682197533283`*^9, 3.9037682282192326`*^9}, {3.9037749238986273`*^9, 
   3.903774942158679*^9}, {3.903774996698408*^9, 3.9037750168580236`*^9}, {
   3.9037750587307277`*^9, 3.903775183539056*^9}, 3.9037752796554685`*^9, {
   3.9037756823822527`*^9, 3.903775755054*^9}, {3.903775826176916*^9, 
   3.9037758833649073`*^9}, {3.903776242920613*^9, 3.903776386373749*^9}, {
   3.903776696986782*^9, 3.9037767554852886`*^9}, {3.9037767924382024`*^9, 
   3.903776851470423*^9}, {3.9037777187047634`*^9, 3.90377775029606*^9}, {
   3.903777793826481*^9, 3.903777819842196*^9}, {3.9037781047890844`*^9, 
   3.903778196943304*^9}, {3.903778233766836*^9, 3.9037782874456463`*^9}, {
   3.903778506959323*^9, 3.9037786196940193`*^9}, {3.903778658319291*^9, 
   3.9037787039477005`*^9}, {3.90377882394034*^9, 3.9037789349872513`*^9}, {
   3.9037791349580336`*^9, 3.9037791707905164`*^9}, {3.903779238967281*^9, 
   3.903779342318043*^9}, {3.9037796799156895`*^9, 3.9037796995892544`*^9}, {
   3.9037797326211233`*^9, 3.9037797641678762`*^9}, {3.9037798537470617`*^9, 
   3.90377986754245*^9}, {3.9037799414446573`*^9, 3.903779945587907*^9}, {
   3.903779995982876*^9, 3.903780004403395*^9}, {3.903780037272769*^9, 
   3.903780083215593*^9}, {3.903780346086627*^9, 3.903780565344816*^9}, {
   3.903780606041752*^9, 3.9037807037630353`*^9}, {3.9037807967389507`*^9, 
   3.90378095015549*^9}, {3.903781662671798*^9, 3.903781745907153*^9}, 
   3.9037817830912943`*^9, {3.9037819602113495`*^9, 3.9037819639418716`*^9}, {
   3.903781999638567*^9, 3.9037820120951595`*^9}, {3.9037820779034944`*^9, 
   3.903782097630228*^9}, {3.9037833450879607`*^9, 3.9037834068903913`*^9}, {
   3.9037834691608906`*^9, 3.9037834916356072`*^9}, {3.9037835315669675`*^9, 
   3.903783551561824*^9}, {3.903783583815935*^9, 3.9037835964415636`*^9}, {
   3.903783643885414*^9, 3.9037837626883087`*^9}, {3.903783810208829*^9, 
   3.903783993500314*^9}, {3.903784496961217*^9, 3.903784619734433*^9}, {
   3.9037871560452023`*^9, 3.903787260747394*^9}, {3.903787326024105*^9, 
   3.9037873430500307`*^9}, {3.9037874889805455`*^9, 
   3.9037875853868413`*^9}, {3.903787627358571*^9, 3.9037878302571754`*^9}, {
   3.903788124362797*^9, 3.903788146043533*^9}, {3.903788179087324*^9, 
   3.9037881857149754`*^9}, {3.9037882280063453`*^9, 
   3.9037882573063383`*^9}, {3.903788296742214*^9, 3.903788308512581*^9}, {
   3.9037883616451783`*^9, 3.903788370873853*^9}, {3.903788855437251*^9, 
   3.90378889051711*^9}, {3.903789031782511*^9, 3.9037890812023125`*^9}, {
   3.9037893899762597`*^9, 3.903789390695738*^9}, {3.903789622833228*^9, 
   3.903789659530774*^9}, {3.9037897937873917`*^9, 3.903789891048684*^9}, {
   3.9037899302401595`*^9, 3.9037899611672707`*^9}, {3.903790468103015*^9, 
   3.9037905529821386`*^9}, {3.903790598690569*^9, 3.9037906334285727`*^9}, {
   3.9037906907098656`*^9, 3.903790774555977*^9}, {3.9037908177682734`*^9, 
   3.903790879268617*^9}, {3.9037912387803016`*^9, 3.903791705772111*^9}, 
   3.903791738533459*^9, {3.903792323773939*^9, 3.9037923575447507`*^9}, {
   3.903797193886198*^9, 3.903797242138958*^9}, {3.9037972851126375`*^9, 
   3.9037973776454706`*^9}, {3.903797552110806*^9, 3.903797643017164*^9}, 
   3.9037982865405006`*^9, {3.903798361567168*^9, 3.9037983673155804`*^9}, {
   3.9037984011980267`*^9, 3.903798404747634*^9}, {3.9037992901407194`*^9, 
   3.9037993003266892`*^9}, {3.903799409846863*^9, 3.9037994152473574`*^9}, {
   3.9037994457461042`*^9, 3.9037994494151697`*^9}, {3.903799486078493*^9, 
   3.9037996796285343`*^9}, {3.903800157687913*^9, 3.9038001831295547`*^9}, {
   3.9038002982581077`*^9, 3.9038003301415787`*^9}, {3.9038004433056793`*^9, 
   3.9038004523797836`*^9}, 3.903800674895852*^9, {3.90380091426812*^9, 
   3.9038009157635193`*^9}, {3.9040246614533863`*^9, 
   3.9040246728947453`*^9}, {3.9040248670508623`*^9, 3.904024938566221*^9}, {
   3.904025046561948*^9, 3.90402511090224*^9}, 3.904025196051536*^9, {
   3.9040252714418864`*^9, 3.904025310778341*^9}, {3.9040253527304063`*^9, 
   3.904025375525178*^9}, {3.9040264705614147`*^9, 3.9040265425386105`*^9}, {
   3.9040266145342083`*^9, 3.9040266706068106`*^9}, {3.904026769710935*^9, 
   3.9040267734355345`*^9}, {3.90402680695931*^9, 3.9040268632360125`*^9}, {
   3.904026942255951*^9, 3.9040269424931107`*^9}, {3.904027122182681*^9, 
   3.904027163776168*^9}, {3.9040271956411753`*^9, 3.904027195988937*^9}, {
   3.9040298271914377`*^9, 3.904029883364492*^9}, {3.9040299248846674`*^9, 
   3.904029987591586*^9}, {3.9040300371668377`*^9, 3.904030041219339*^9}, {
   3.904030085879607*^9, 3.9040300879375114`*^9}, {3.9040301554637833`*^9, 
   3.9040301587915072`*^9}, {3.9040305815021763`*^9, 
   3.9040305966058955`*^9}, {3.904030628678569*^9, 3.9040306376464124`*^9}, {
   3.9040308652661247`*^9, 3.9040308855493927`*^9}, {3.904031080748942*^9, 
   3.9040310925098395`*^9}, {3.904031269614999*^9, 3.904031290140585*^9}, {
   3.9040314160066414`*^9, 3.904031419747205*^9}, {3.9040323969333425`*^9, 
   3.904032444336259*^9}, {3.9040325276642456`*^9, 3.904032538721712*^9}, {
   3.90403328767414*^9, 3.904033349662304*^9}, {3.9040333837227197`*^9, 
   3.904033429003405*^9}, {3.9040339613627014`*^9, 3.904034000557909*^9}, {
   3.9040350164504995`*^9, 3.9040351253324203`*^9}, {3.9040358855311556`*^9, 
   3.9040360030386825`*^9}, {3.904036835765459*^9, 3.904036931806146*^9}, {
   3.9040429849549346`*^9, 3.9040431117761946`*^9}, {3.904043343746337*^9, 
   3.9040434586155515`*^9}, 3.904044314350748*^9, {3.9040474366317625`*^9, 
   3.9040474447384024`*^9}, {3.9040480486468067`*^9, 
   3.9040480772920623`*^9}, {3.9040481332628517`*^9, 
   3.9040481388342457`*^9}, {3.9040481977006226`*^9, 3.904048220237974*^9}, {
   3.904049212215225*^9, 3.9040492630915155`*^9}, {3.9040499924865*^9, 
   3.9040500350171237`*^9}, {3.9040501015460997`*^9, 3.904050107913819*^9}, {
   3.90405074210599*^9, 3.9040508431551313`*^9}, 3.9040509886953955`*^9, {
   3.904051479730313*^9, 3.904051559984273*^9}, {3.9040515909442816`*^9, 
   3.9040516271329308`*^9}, {3.9040524791060715`*^9, 
   3.9040525244134398`*^9}, {3.904108644335151*^9, 3.904108666831067*^9}, {
   3.904108781274054*^9, 3.9041087815374155`*^9}, {3.9041088866626654`*^9, 
   3.9041089413405085`*^9}, {3.9041089941995087`*^9, 
   3.9041090340552044`*^9}, {3.9041102375270834`*^9, 3.904110241115018*^9}, {
   3.9041105935054026`*^9, 3.90411059702464*^9}, {3.904113811925028*^9, 
   3.9041138121445208`*^9}, {3.9041143657712374`*^9, 
   3.9041144015563354`*^9}, {3.9041144681554375`*^9, 
   3.9041145037672195`*^9}, {3.9041152248903956`*^9, 
   3.9041152685354333`*^9}, {3.90411531103411*^9, 3.90411549766064*^9}, {
   3.90411720920931*^9, 3.904117212557748*^9}, {3.9041174536674747`*^9, 
   3.9041175269450397`*^9}, {3.904117611503191*^9, 3.9041177061243067`*^9}, {
   3.90411774471025*^9, 3.90411775954618*^9}, 3.9041177943223557`*^9, {
   3.904117832286007*^9, 3.9041178486788683`*^9}, {3.904118278179315*^9, 
   3.904118331669216*^9}, {3.9041185192891865`*^9, 3.9041185317000113`*^9}, {
   3.904118997128101*^9, 3.904119000140568*^9}, {3.904119045478055*^9, 
   3.90411904849838*^9}, 3.904120043637679*^9, {3.904120241693875*^9, 
   3.904120258261162*^9}, {3.9041210735229087`*^9, 3.904121091721779*^9}, {
   3.904121182446674*^9, 3.9041211989168096`*^9}, {3.9041213518844867`*^9, 
   3.9041213737652807`*^9}, {3.904121410875848*^9, 3.9041214161152363`*^9}, {
   3.9041215079645767`*^9, 3.9041215191383524`*^9}, {3.904138965566516*^9, 
   3.904138970818923*^9}, 3.9041391057464037`*^9, {3.904139165494955*^9, 
   3.90413917881936*^9}, {3.9041411064748816`*^9, 3.90414120150634*^9}, {
   3.9041412318704696`*^9, 3.9041412981315393`*^9}, {3.9041415167308655`*^9, 
   3.904141575780599*^9}, {3.9041432898223643`*^9, 3.904143453505875*^9}, {
   3.90414479488126*^9, 3.904144838744419*^9}, {3.904145040479823*^9, 
   3.904145051958623*^9}, {3.904145738324079*^9, 3.9041458137914762`*^9}, {
   3.904146333305916*^9, 3.904146457494884*^9}, {3.904146701001079*^9, 
   3.9041467288436813`*^9}, {3.904983677241268*^9, 3.9049836820808287`*^9}, {
   3.9049837308426795`*^9, 3.9049837444226227`*^9}, {3.904983796747682*^9, 
   3.904983826667018*^9}},
 CellLabel->
  "In[574]:=",ExpressionUUID->"5e0f2115-4154-4f33-bc96-b5692730e154"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Algorithm", " ", "to", " ", "determine", " ", "the", " ", "necessary", 
    " ", "operations", " ", "for", " ", "any", " ", "two", " ", "qubits", " ",
     "to", " ", "share", " ", "connection"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "By", " ", "\"\<Rail\>\"", " ", "we", " ", "mean", " ", "they", " ", 
     "are", " ", "colinear", " ", "along", " ", "the", " ", "x"}], "-", 
    RowBox[{"axis", " ", "of", " ", "the", " ", "grid"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"SWAPScheduleARP", "[", 
     RowBox[{"GateData_", ",", "A_", ",", "B_", ",", "LocTrackerARP_"}], 
     "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"LocTracker", "=", "LocTrackerARP"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Same", " ", "Rail"}], "*)"}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"EvenQ", "[", 
          RowBox[{"Abs", "[", 
           RowBox[{
            RowBox[{"LocTracker", "[", 
             RowBox[{"[", 
              RowBox[{"A", "+", "1"}], "]"}], "]"}], "-", 
            RowBox[{"LocTracker", "[", 
             RowBox[{"[", 
              RowBox[{"B", "+", "1"}], "]"}], "]"}]}], "]"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Print", "[", "\"\<Same Rail\>\"", "]"}], ";"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"LocTracker", "[", 
              RowBox[{"[", 
               RowBox[{"A", "+", "1"}], "]"}], "]"}], "==", 
             RowBox[{
              RowBox[{"LocTracker", "[", 
               RowBox[{"[", 
                RowBox[{"B", "+", "1"}], "]"}], "]"}], "+", "2"}]}], "||", 
            RowBox[{
             RowBox[{"LocTracker", "[", 
              RowBox[{"[", 
               RowBox[{"A", "+", "1"}], "]"}], "]"}], "==", 
             RowBox[{
              RowBox[{"LocTracker", "[", 
               RowBox[{"[", 
                RowBox[{"B", "+", "1"}], "]"}], "]"}], "-", "2"}]}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"LocTracker", ",", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{"SU4GateDCARP", "[", 
                RowBox[{"GateData", ",", "A", ",", "B"}], "]"}], "}"}], 
              "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"MaxPosi", "=", 
             RowBox[{"Max", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"LocTracker", "[", 
                 RowBox[{"[", 
                  RowBox[{"A", "+", "1"}], "]"}], "]"}], ",", 
                RowBox[{"LocTracker", "[", 
                 RowBox[{"[", 
                  RowBox[{"B", "+", "1"}], "]"}], "]"}]}], "}"}], "]"}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"MinPosi", "=", 
             RowBox[{"Min", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"LocTracker", "[", 
                 RowBox[{"[", 
                  RowBox[{"A", "+", "1"}], "]"}], "]"}], ",", 
                RowBox[{"LocTracker", "[", 
                 RowBox[{"[", 
                  RowBox[{"B", "+", "1"}], "]"}], "]"}]}], "}"}], "]"}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"MaxPosQi", "=", 
             RowBox[{
              RowBox[{
               RowBox[{"Flatten", "[", 
                RowBox[{"Position", "[", 
                 RowBox[{"LocTracker", ",", "MaxPosi"}], "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], "-", "1"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"li", "=", 
             RowBox[{
              FractionBox[
               RowBox[{"(", 
                RowBox[{"MaxPosi", "-", "MinPosi"}], ")"}], "2"], "-", 
              "1"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{"\"\<m= \>\"", ",", "li"}], "]"}], ";"}], "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"OutputLayer", "=", 
             RowBox[{"Flatten", "[", 
              RowBox[{"Join", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Table", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"MaxPos", "=", 
                    RowBox[{"Max", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"LocTracker", "[", 
                    RowBox[{"[", 
                    RowBox[{"A", "+", "1"}], "]"}], "]"}], ",", 
                    RowBox[{"LocTracker", "[", 
                    RowBox[{"[", 
                    RowBox[{"B", "+", "1"}], "]"}], "]"}]}], "}"}], "]"}]}], 
                   ";", "\[IndentingNewLine]", 
                   RowBox[{"MaxPosQ", "=", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Position", "[", 
                    RowBox[{"LocTracker", ",", "MaxPos"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", "1"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"MinPos", "=", 
                    RowBox[{"Min", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"LocTracker", "[", 
                    RowBox[{"[", 
                    RowBox[{"A", "+", "1"}], "]"}], "]"}], ",", 
                    RowBox[{"LocTracker", "[", 
                    RowBox[{"[", 
                    RowBox[{"B", "+", "1"}], "]"}], "]"}]}], "}"}], "]"}]}], 
                   ";", "\[IndentingNewLine]", 
                   RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"Print", "[", 
                    RowBox[{
                    "\"\<MaxPos \>\"", ",", "MaxPos", ",", "\"\< MinPos \>\"",
                     ",", "MinPos", ",", " ", "\"\< MaxPosQ \>\"", ",", 
                    "MaxPosQ"}], " ", "]"}], ";"}], "*)"}], 
                   "\[IndentingNewLine]", 
                   RowBox[{"MoveTarg", "=", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Position", "[", 
                    RowBox[{"LocTracker", ",", 
                    RowBox[{"MaxPos", "-", "2"}]}], "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", "1"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"LocTracker", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Position", "[", 
                    RowBox[{"LocTracker", ",", 
                    RowBox[{"MaxPos", "-", "2"}]}], "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "+=", "2"}],
                    ";", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"LocTracker", "[", 
                    RowBox[{"[", 
                    RowBox[{"MaxPosQ", "+", "1"}], "]"}], "]"}], "-=", "2"}], 
                   ";", "\[IndentingNewLine]", 
                   RowBox[{"{", 
                    RowBox[{
                    SubscriptBox["SWAPDCARPRL", 
                    RowBox[{"MaxPosQi", ",", "MoveTarg"}]], ",", 
                    SubscriptBox["SWAPLoc", 
                    RowBox[{"MoveTarg", ",", "MaxPosQi"}]]}], "}"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", "1", ",", "li"}], "}"}]}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"SU4GateDCARP", "[", 
                  RowBox[{"GateData", ",", "A", ",", "B"}], "]"}], "}"}]}], 
               "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{"\"\<LocTracker\>\"", ",", "LocTracker"}], "]"}], 
              ";"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"LocTracker", ",", "OutputLayer"}], "}"}]}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Different", " ", "rail"}], ",", " ", 
           RowBox[{"A", " ", "is", " ", "the", " ", "top", " ", "rail"}]}], 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"OddQ", "[", 
          RowBox[{"LocTracker", "[", 
           RowBox[{"[", 
            RowBox[{"A", "+", "1"}], "]"}], "]"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Print", "[", "\"\<A odd, Diff Rail\>\"", "]"}], ";"}], 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"Which", "[", "\[IndentingNewLine]", 
          RowBox[{"(*", "Aligned", "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"LocTracker", "[", 
             RowBox[{"[", 
              RowBox[{"A", "+", "1"}], "]"}], "]"}], "==", 
            RowBox[{
             RowBox[{"LocTracker", "[", 
              RowBox[{"[", 
               RowBox[{"B", "+", "1"}], "]"}], "]"}], "+", "1"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"Print", "[", "\"\<Aligned\>\"", "]"}], ";"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"LocTracker", ",", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{"SU4GateDCARP", "[", 
                RowBox[{"GateData", ",", "A", ",", "B"}], "]"}], "}"}], 
              "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"A", " ", "Right", " ", "of", " ", "B"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"LocTracker", "[", 
             RowBox[{"[", 
              RowBox[{"A", "+", "1"}], "]"}], "]"}], ">", 
            RowBox[{"LocTracker", "[", 
             RowBox[{"[", 
              RowBox[{"B", "+", "1"}], "]"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"Print", "[", "\"\<A RHS B\>\"", "]"}], ";"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"m", "=", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"LocTracker", "[", 
                 RowBox[{"[", 
                  RowBox[{"A", "+", "1"}], "]"}], "]"}], "-", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"LocTracker", "[", 
                   RowBox[{"[", 
                    RowBox[{"B", "+", "1"}], "]"}], "]"}], "+", "1"}], 
                 ")"}]}], ")"}], "/", "2"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"OutputLayer", "=", 
             RowBox[{"Flatten", "[", 
              RowBox[{"Join", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Table", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"MoveTarg", "=", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Position", "[", 
                    RowBox[{"LocTracker", ",", 
                    RowBox[{
                    RowBox[{"LocTracker", "[", 
                    RowBox[{"[", 
                    RowBox[{"A", "+", "1"}], "]"}], "]"}], "-", "2"}]}], 
                    "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", "1"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"LocTracker", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Position", "[", 
                    RowBox[{"LocTracker", ",", 
                    RowBox[{
                    RowBox[{"LocTracker", "[", 
                    RowBox[{"[", 
                    RowBox[{"A", "+", "1"}], "]"}], "]"}], "-", "2"}]}], 
                    "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "+=", "2"}],
                    ";", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"LocTracker", "[", 
                    RowBox[{"[", 
                    RowBox[{"A", "+", "1"}], "]"}], "]"}], "-=", "2"}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"Print", "[", 
                    RowBox[{
                    "\"\<Desired SWAP: \>\"", " ", ",", "A", ",", " ", 
                    "\"\< -> \>\"", ",", " ", "MoveTarg"}], "]"}], ";"}], 
                    "*)"}], "\[IndentingNewLine]", 
                   RowBox[{"{", 
                    RowBox[{
                    SubscriptBox["SWAPDCARPRL", 
                    RowBox[{"MoveTarg", ",", "A"}]], ",", 
                    SubscriptBox["SWAPLoc", 
                    RowBox[{"MoveTarg", ",", "A"}]]}], "}"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", "1", ",", "m"}], "}"}]}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"SU4GateDCARP", "[", 
                  RowBox[{"GateData", ",", "A", ",", "B"}], "]"}], "}"}]}], 
               "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{"\"\<LocTracker\>\"", ",", "LocTracker"}], "]"}], 
              ";"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"LocTracker", ",", "OutputLayer"}], "}"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"A", " ", "left", " ", "of", " ", "B"}], "*)"}], 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"LocTracker", "[", 
             RowBox[{"[", 
              RowBox[{"A", "+", "1"}], "]"}], "]"}], "<", 
            RowBox[{"LocTracker", "[", 
             RowBox[{"[", 
              RowBox[{"B", "+", "1"}], "]"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"Print", "[", "\"\<A LHS B\>\"", "]"}], ";"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"m", "=", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"LocTracker", "[", 
                 RowBox[{"[", 
                  RowBox[{"B", "+", "1"}], "]"}], "]"}], "-", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"LocTracker", "[", 
                   RowBox[{"[", 
                    RowBox[{"A", "+", "1"}], "]"}], "]"}], "-", "1"}], 
                 ")"}]}], ")"}], "/", "2"}]}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"OutputLayer", "=", 
             RowBox[{"Flatten", "[", 
              RowBox[{"Join", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Table", "[", "\[IndentingNewLine]", 
                 RowBox[{"(*", 
                  RowBox[{
                   RowBox[{"Print", "[", 
                    RowBox[{
                    "\"\<LocTracker Before \>\"", ",", " ", "LocTracker"}], 
                    "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"MoveTarg", "=", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Position", "[", 
                    RowBox[{"LocTracker", ",", 
                    RowBox[{
                    RowBox[{"LocTracker", "[", 
                    RowBox[{"[", 
                    RowBox[{"B", "+", "1"}], "]"}], "]"}], "-", "2"}]}], 
                    "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", "1"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"LocTracker", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Position", "[", 
                    RowBox[{"LocTracker", ",", 
                    RowBox[{
                    RowBox[{"LocTracker", "[", 
                    RowBox[{"[", 
                    RowBox[{"B", "+", "1"}], "]"}], "]"}], "-", "2"}]}], 
                    "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "+=", "2"}],
                    ";", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"LocTracker", "[", 
                    RowBox[{"[", 
                    RowBox[{"B", "+", "1"}], "]"}], "]"}], "-=", "2"}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"Print", "[", 
                    RowBox[{
                    "\"\<Desired SWAP: \>\"", " ", ",", " ", "B", ",", " ", 
                    "\"\< -> \>\"", ",", " ", "MoveTarg"}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Print", "[", 
                    RowBox[{
                    "\"\<LocTracker After \>\"", ",", " ", "LocTracker"}], 
                    "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
                   RowBox[{"{", 
                    RowBox[{
                    SubscriptBox["SWAPDCARPRL", 
                    RowBox[{"MoveTarg", ",", "B"}]], ",", 
                    SubscriptBox["SWAPLoc", 
                    RowBox[{"MoveTarg", ",", "B"}]]}], "}"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", "1", ",", "m"}], "}"}]}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"SU4GateDCARP", "[", 
                  RowBox[{"GateData", ",", "A", ",", "B"}], "]"}], "}"}]}], 
               "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{"\"\<LocTracker\>\"", ",", "LocTracker"}], "]"}], 
              ";"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"LocTracker", ",", "OutputLayer"}], "}"}]}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Different", " ", "rail"}], ",", " ", 
           RowBox[{"B", " ", "is", " ", "the", " ", "top", " ", "rail"}]}], 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"OddQ", "[", 
          RowBox[{"LocTracker", "[", 
           RowBox[{"[", " ", 
            RowBox[{"B", "+", "1"}], "]"}], "]"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Print", "[", "\"\<Diff Rail, B top\>\"", "]"}], ";"}], 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"Which", "[", "\[IndentingNewLine]", 
          RowBox[{"(*", "Aligned", "*)"}], "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"LocTracker", "[", 
             RowBox[{"[", 
              RowBox[{"A", "+", "1"}], "]"}], "]"}], "==", 
            RowBox[{
             RowBox[{"LocTracker", "[", 
              RowBox[{"[", 
               RowBox[{"B", "+", "1"}], "]"}], "]"}], "-", "1"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"Print", "[", "\"\<Aligned\>\"", "]"}], ";"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"LocTracker", ",", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{"SU4GateDCARP", "[", 
                RowBox[{"GateData", ",", "A", ",", "B"}], "]"}], "}"}], 
              "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"A", " ", "right", " ", "of", " ", "B"}], "*)"}], 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"LocTracker", "[", 
             RowBox[{"[", 
              RowBox[{"A", "+", "1"}], "]"}], "]"}], ">", 
            RowBox[{"LocTracker", "[", 
             RowBox[{"[", 
              RowBox[{"B", "+", "1"}], "]"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"Print", "[", "\"\<A RHS B\>\"", "]"}], ";"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"m", "=", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"LocTracker", "[", 
                 RowBox[{"[", 
                  RowBox[{"A", "+", "1"}], "]"}], "]"}], "-", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"LocTracker", "[", 
                   RowBox[{"[", 
                    RowBox[{"B", "+", "1"}], "]"}], "]"}], "-", "1"}], 
                 ")"}]}], ")"}], "/", "2"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"OutputLayer", "=", 
             RowBox[{"Flatten", "[", 
              RowBox[{"Join", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Table", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"MoveTarg", "=", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Position", "[", 
                    RowBox[{"LocTracker", ",", 
                    RowBox[{
                    RowBox[{"LocTracker", "[", 
                    RowBox[{"[", 
                    RowBox[{"A", "+", "1"}], "]"}], "]"}], "-", "2"}]}], 
                    "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", "1"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"LocTracker", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Position", "[", 
                    RowBox[{"LocTracker", ",", 
                    RowBox[{
                    RowBox[{"LocTracker", "[", 
                    RowBox[{"[", 
                    RowBox[{"A", "+", "1"}], "]"}], "]"}], "-", "2"}]}], 
                    "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "+=", "2"}],
                    ";", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"LocTracker", "[", 
                    RowBox[{"[", 
                    RowBox[{"A", "+", "1"}], "]"}], "]"}], "-=", "2"}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"Print", "[", 
                    RowBox[{
                    "\"\<Desired SWAP: \>\"", " ", ",", " ", "A", ",", " ", 
                    "\"\< -> \>\"", ",", " ", "MoveTarg"}], "]"}], ";"}], 
                    "*)"}], "\[IndentingNewLine]", 
                   RowBox[{"{", 
                    RowBox[{
                    SubscriptBox["SWAPDCARPRL", 
                    RowBox[{"MoveTarg", ",", "A"}]], ",", 
                    SubscriptBox["SWAPLoc", 
                    RowBox[{"MoveTarg", ",", "A"}]]}], "}"}]}], ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", "1", ",", "m"}], "}"}]}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"SU4GateDCARP", "[", 
                  RowBox[{"GateData", ",", "A", ",", "B"}], "]"}], "}"}]}], 
               "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{"\"\<LocTracker\>\"", ",", "LocTracker"}], "]"}], 
              ";"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"LocTracker", ",", "OutputLayer"}], "}"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"A", " ", "Left", " ", "of", " ", "B"}], "*)"}], 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"LocTracker", "[", 
             RowBox[{"[", 
              RowBox[{"A", "+", "1"}], "]"}], "]"}], "<", 
            RowBox[{"LocTracker", "[", 
             RowBox[{"[", 
              RowBox[{"B", "+", "1"}], "]"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"Print", "[", "\"\<A LHS B\>\"", "]"}], ";"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"m", "=", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"LocTracker", "[", 
                 RowBox[{"[", 
                  RowBox[{"B", "+", "1"}], "]"}], "]"}], "-", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"LocTracker", "[", 
                   RowBox[{"[", 
                    RowBox[{"A", "+", "1"}], "]"}], "]"}], "+", "1"}], 
                 ")"}]}], ")"}], "/", "2"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"OutputLayer", "=", 
             RowBox[{"Flatten", "[", 
              RowBox[{"Join", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Table", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"MoveTarg", "=", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Position", "[", 
                    RowBox[{"LocTracker", ",", 
                    RowBox[{
                    RowBox[{"LocTracker", "[", 
                    RowBox[{"[", 
                    RowBox[{"B", "+", "1"}], "]"}], "]"}], "-", "2"}]}], 
                    "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", "1"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"LocTracker", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Position", "[", 
                    RowBox[{"LocTracker", ",", 
                    RowBox[{
                    RowBox[{"LocTracker", "[", 
                    RowBox[{"[", 
                    RowBox[{"B", "+", "1"}], "]"}], "]"}], "-", "2"}]}], 
                    "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "+=", "2"}],
                    ";", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"LocTracker", "[", 
                    RowBox[{"[", 
                    RowBox[{"B", "+", "1"}], "]"}], "]"}], "-=", "2"}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"Print", "[", 
                    RowBox[{
                    "\"\<Desired SWAP: \>\"", " ", ",", "B", " ", ",", " ", 
                    "\"\< -> \>\"", ",", " ", "MoveTarg"}], "]"}], ";"}], 
                    "*)"}], "\[IndentingNewLine]", 
                   RowBox[{"{", 
                    RowBox[{
                    SubscriptBox["SWAPDCARPRL", 
                    RowBox[{"MoveTarg", ",", "B"}]], ",", 
                    SubscriptBox["SWAPLoc", 
                    RowBox[{"MoveTarg", ",", "B"}]]}], "}"}]}], ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", "1", ",", "m"}], "}"}]}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{"SU4GateDCARP", "[", 
                  RowBox[{"GateData", ",", "A", ",", "B"}], "]"}], "}"}]}], 
               "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{"\"\<LocTracker\>\"", ",", "LocTracker"}], "]"}], 
              ";"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"LocTracker", ",", "OutputLayer"}], "}"}]}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
     "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 CellLabel->
  "In[576]:=",ExpressionUUID->"dab07584-1db1-4a5b-af72-70e2eb81442c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Defining", " ", 
    RowBox[{"QuEST", "'"}], "s", " ", "Rydberg", " ", "Blockade", " ", 
    "Check", " ", "in", " ", "a", " ", "permanent", " ", "function", " ", 
    "such", " ", "that", " ", "it", " ", "can", " ", "be", " ", "used", " ", 
    "without", " ", "constantly", " ", "editing", " ", "the", " ", "code"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"LocTrack", "[", "Nq_", "]"}], ":=", 
    RowBox[{"Range", "[", 
     RowBox[{"0", ",", 
      RowBox[{"Nq", "-", "1"}]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"distloc", "[", 
      RowBox[{"q1_", ",", "q2_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"Norm", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"qubitLocs", "[", "q1", "]"}], "-", 
         RowBox[{"qubitLocs", "[", "q2", "]"}]}], ",", "2"}], "]"}], "*", 
      RowBox[{"userconfig", "[", "UnitLattice", "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"blockadeCheck", "[", "q_List", "]"}], ":=", 
     RowBox[{"And", "@@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"distloc", "@@", "#"}], "<=", " ", 
           RowBox[{"userconfig", "[", "BlockadeRadius", "]"}]}], ")"}], "&"}],
         "/@", 
        RowBox[{"Subsets", "[", 
         RowBox[{
          RowBox[{"Flatten", "[", "q", "]"}], ",", 
          RowBox[{"{", "2", "}"}]}], "]"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Fraction", "[", 
     RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
    FractionBox["a", "b"]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"KetList", "[", "NQ_", "]"}], ":=", 
    RowBox[{"Table", "[", 
     RowBox[{"i", ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "0", ",", 
        RowBox[{
         SuperscriptBox["2", "NQ"], "-", "1"}], ",", "1"}], "}"}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NRandQbits", "[", 
     RowBox[{"NQ_", ",", "i_"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"i", "==", "0"}], ",", 
      RowBox[{"Range", "[", 
       RowBox[{"0", ",", 
        RowBox[{"NQ", "-", "1"}]}], "]"}], ",", 
      RowBox[{"RandomSample", "[", 
       RowBox[{
        RowBox[{"Range", "[", 
         RowBox[{"0", ",", 
          RowBox[{"NQ", "-", "1"}]}], "]"}], ",", "NQ"}], "]"}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"NRandQbits", "[", 
      RowBox[{"NQ_", ",", "i_"}], "]"}], ":=", 
     RowBox[{"Range", "[", 
      RowBox[{"0", ",", "NQ"}], "]"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Randomly", " ", "generated", " ", "list"}], ",", " ", 
     RowBox[{
     "each", " ", "2", " ", "qubits", " ", "represent", " ", "a", " ", 
      "randomly", " ", "generated", " ", "pair"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"QList", "=", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "3", ",", "2", ",", "7", ",", "1", ",", "5", ",", "6", ",", 
       "4", ",", "8"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Constructed", " ", "list", " ", "which", " ", "replaces", " ", "the", 
     " ", "qubit", " ", "labels", " ", "with", " ", "their", " ", 
     "respective", " ", "current", " ", "grid", " ", "position", " ", 
     "labels"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"QLoclist", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"LocTrack", "[", 
        RowBox[{"Length", "[", "QList", "]"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"QList", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "+", "1"}], "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "QList", "]"}]}], "}"}]}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Sort", " ", "the", " ", "qubit", " ", "pairs", " ", "in", " ", "such", 
     " ", "a", " ", "way", " ", "that", " ", "the", " ", "pairs", " ", 
     "which", " ", "require", " ", "the", " ", "least", " ", "operations", 
     " ", "to", " ", "connect", " ", "are", " ", "first", " ", "in", " ", 
     "the", " ", "schedule"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"RTN", ":", " ", 
      RowBox[{"Pair", " ", "#"}]}], ",", " ", 
     RowBox[{
     "Seperation", " ", "between", " ", "qubits", " ", "as", " ", "indicator",
       " ", "of", " ", "how", " ", "many", " ", "operations", " ", "needed", 
      " ", "to", " ", "connect"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"GateOrdering", "=", 
    RowBox[{
     RowBox[{"SortBy", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"i", "-", 
            RowBox[{"Quotient", "[", 
             RowBox[{"i", ",", "2"}], "]"}]}], ",", 
           RowBox[{"Abs", "[", 
            RowBox[{
             RowBox[{"QLoclist", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "-", 
             RowBox[{"QLoclist", "[", 
              RowBox[{"[", 
               RowBox[{"i", "+", "1"}], "]"}], "]"}]}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{
            RowBox[{"Length", "[", "QLoclist", "]"}], "-", "1"}], ",", "2"}], 
          "}"}]}], "]"}], ",", "Last"}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"RQSOrd", "=", 
    RowBox[{"Flatten", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"QList", "[", 
        RowBox[{"[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"2", "*", 
             RowBox[{"GateOrdering", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "-", "1"}], ",", 
           RowBox[{"2", "*", 
            RowBox[{"GateOrdering", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}]}], "}"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "GateOrdering", "]"}]}], "}"}]}], "]"}], 
     "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"CheckHeavyOutputProb", "[", 
      RowBox[{"PoutcomesIMPLEMENTED_", ",", "PoutcomesMODEL_"}], "]"}], ":=", 
     RowBox[{"Pick", "[", 
      RowBox[{"PoutcomesIMPLEMENTED", ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"PoutcomesMODEL", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ">=", 
            RowBox[{"Median", "[", "PoutcomesMODEL", "]"}]}], ",", "True", 
           ",", "False"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "PoutcomesMODEL", "]"}]}], "}"}]}], "]"}]}],
       "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.9049794266692967`*^9, 3.9049794273603716`*^9}, {
   3.904979630779292*^9, 3.9049796311505456`*^9}, 3.905314916014863*^9, {
   3.905319109163974*^9, 3.9053191095228043`*^9}, 3.905333986475275*^9, {
   3.905569407052249*^9, 3.905569429502185*^9}, {3.9055713011498933`*^9, 
   3.905571307694762*^9}},
 CellLabel->
  "In[646]:=",ExpressionUUID->"c9c94bdf-c028-4e0f-9d9e-0a5c768ec1c1"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "3", ",", "2", ",", "7", ",", "1", ",", "5", ",", "6", ",", "4", 
   ",", "8"}], "}"}]], "Output",
 CellChangeTimes->{3.905319113407406*^9, 3.9053192097202835`*^9, 
  3.905325548163672*^9, 3.9053294399698195`*^9, 3.9054817135075283`*^9, 
  3.905507582530695*^9, 3.9055102928737755`*^9, 3.9055103830611844`*^9, 
  3.905569432144249*^9, 3.905571309958454*^9},
 CellLabel->
  "Out[653]=",ExpressionUUID->"6989417d-0b47-44e6-8113-31eff9ca8ede"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"4", ",", "1", ",", "3", ",", "2"}], "}"}]], "Output",
 CellChangeTimes->{3.905319113407406*^9, 3.9053192097202835`*^9, 
  3.905325548163672*^9, 3.9053294399698195`*^9, 3.9054817135075283`*^9, 
  3.905507582530695*^9, 3.9055102928737755`*^9, 3.9055103830611844`*^9, 
  3.905569432144249*^9, 3.9055713099664593`*^9},
 CellLabel->
  "Out[654]=",ExpressionUUID->"35ae9f65-b1c5-43c1-a1c2-c7c810af4f98"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "6", ",", "4", ",", "0", ",", "3", ",", "1", ",", "5", ",", "2", ",", "7"}],
   "}"}]], "Output",
 CellChangeTimes->{3.905319113407406*^9, 3.9053192097202835`*^9, 
  3.905325548163672*^9, 3.9053294399698195`*^9, 3.9054817135075283`*^9, 
  3.905507582530695*^9, 3.9055102928737755`*^9, 3.9055103830611844`*^9, 
  3.905569432144249*^9, 3.90557130997386*^9},
 CellLabel->
  "Out[655]=",ExpressionUUID->"be6113c4-adb3-44ed-bfd8-2d291b349879"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"SU4GateARPMove", "[", 
   RowBox[{"DataSet_", ",", "q1_", ",", "q2_"}], "]"}], ":=", 
  RowBox[{"SequenceSplit", "[", 
   RowBox[{
    RowBox[{"Flatten", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"a", "=", 
         RowBox[{"Reverse", "[", 
          RowBox[{"IntegerPart", "[", 
           RowBox[{"ToExpression", "[", 
            RowBox[{"StringSplit", "[", 
             RowBox[{
              RowBox[{"StringTrim", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"StringSplit", "[", 
                  RowBox[{
                   RowBox[{"DataSet", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<, [\>\""}], 
                  "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ",", "\"\<]\>\""}], "]"}], 
              ",", "\"\<,\>\""}], "]"}], "]"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"b", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "a", "]"}], "==", "1"}], ",", 
           RowBox[{
            RowBox[{"StringSplit", "[", 
             RowBox[{
              RowBox[{"StringSplit", "[", 
               RowBox[{
                RowBox[{"StringTrim", "[", 
                 RowBox[{
                  RowBox[{"StringTrim", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringSplit", "[", 
                    RowBox[{
                    RowBox[{"DataSet", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<, [\>\""}], 
                    "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<[\>\""}], "]"}],
                   ",", "\"\<]\>\""}], "]"}], ",", "\"\<,\>\""}], "]"}], ",", 
              "\"\<'\>\""}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{"StringSplit", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"StringSplit", "[", 
                RowBox[{
                 RowBox[{"StringSplit", "[", 
                  RowBox[{
                   RowBox[{"StringTrim", "[", 
                    RowBox[{
                    RowBox[{"StringTrim", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"StringSplit", "[", 
                    RowBox[{
                    RowBox[{"DataSet", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<, [\>\""}], 
                    "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<[\>\""}], "]"}],
                     ",", "\"\<]\>\""}], "]"}], ",", "\"\<,\>\""}], "]"}], 
                 ",", "\"\<'\>\""}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", "\"\<C\>\""}], 
             "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"c", "=", 
         RowBox[{"StringReplace", "[", 
          RowBox[{
           RowBox[{"StringTrim", "[", 
            RowBox[{
             RowBox[{"StringTrim", "[", 
              RowBox[{
               RowBox[{"StringSplit", "[", 
                RowBox[{
                 RowBox[{"DataSet", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<, [\>\""}], "]"}],
                "[", 
               RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", "\"\<]]\>\""}], 
            "]"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\"\<(\>\"", "->", "\"\<[\>\""}], ",", 
             RowBox[{"\"\<)\>\"", "->", "\"\<]\>\""}]}], "}"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"c", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"StringContainsQ", "[", 
            RowBox[{"c", ",", "\"\<e\>\""}], "]"}], ",", 
           RowBox[{
            RowBox[{"d", "=", 
             RowBox[{"StringSplit", "[", 
              RowBox[{"c", ",", "\"\<e\>\""}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ToExpression", "[", 
              RowBox[{"d", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], "*", 
             RowBox[{"10", "^", 
              RowBox[{"ToExpression", "[", 
               RowBox[{"d", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}]}]}]}], ",", 
           RowBox[{"ToExpression", "[", "c", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"a", "=", 
         RowBox[{"ReplaceAll", "[", 
          RowBox[{"a", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"0", "->", "q1"}], ",", 
             RowBox[{"1", "->", "q2"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "a", "]"}], "==", "2"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"StringContainsQ", "[", 
             RowBox[{"b", ",", "\"\<SWAP\>\""}], "]"}], ",", 
            RowBox[{"Subscript", "[", 
             RowBox[{
              RowBox[{"ToExpression", "[", "SWAP", "]"}], ",", 
              RowBox[{"a", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"a", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"TwoQ", ",", 
              RowBox[{"Subscript", "[", 
               RowBox[{"CZARPPar", ",", 
                RowBox[{"a", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ",", 
                RowBox[{"a", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", "TwoQ"}], 
             "}"}]}], "]"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"c", "===", 
             RowBox[{"{", "}"}]}], ",", 
            RowBox[{"Subscript", "[", 
             RowBox[{
              RowBox[{"ToExpression", "[", "b", "]"}], ",", 
              RowBox[{"a", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
            RowBox[{
             RowBox[{"Subscript", "[", 
              RowBox[{
               RowBox[{"ToExpression", "[", "b", "]"}], ",", 
               RowBox[{"a", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "[", "c", "]"}]}], 
           "]"}]}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "DataSet", "]"}]}], "}"}]}], "]"}], "]"}], 
    ",", 
    RowBox[{"{", "TwoQ", "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.9034218314896655`*^9, 3.903421866770581*^9}, {
  3.9034219186458883`*^9, 3.9034219418196435`*^9}, {3.903422767104711*^9, 
  3.903422770499304*^9}, {3.9035033797771573`*^9, 3.9035033804798017`*^9}},
 CellLabel->
  "In[588]:=",ExpressionUUID->"290df099-ece3-4b61-bb6b-ece1925cb0e8"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"NQ", "=", "5"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RQs", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "2", ",", "3", ",", "4"}], "}"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Parallelised", " ", "SU4", " ", "Gate", " ", "layer", " ", "generators"}],
    "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SU4GateARPParMove", "[", 
    RowBox[{"DataSet_", ",", "q1_", ",", "q2_"}], "]"}], ":=", 
   RowBox[{"SequenceSplit", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"a", "=", 
          RowBox[{"Reverse", "[", 
           RowBox[{"IntegerPart", "[", 
            RowBox[{"ToExpression", "[", 
             RowBox[{"StringSplit", "[", 
              RowBox[{
               RowBox[{"StringTrim", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"StringSplit", "[", 
                   RowBox[{
                    RowBox[{"DataSet", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<, [\>\""}], 
                   "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", "\"\<]\>\""}], "]"}], 
               ",", "\"\<,\>\""}], "]"}], "]"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"b", "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "a", "]"}], "==", "1"}], ",", 
            RowBox[{
             RowBox[{"StringSplit", "[", 
              RowBox[{
               RowBox[{"StringSplit", "[", 
                RowBox[{
                 RowBox[{"StringTrim", "[", 
                  RowBox[{
                   RowBox[{"StringTrim", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"StringSplit", "[", 
                    RowBox[{
                    RowBox[{"DataSet", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<, [\>\""}], 
                    "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<[\>\""}], "]"}],
                    ",", "\"\<]\>\""}], "]"}], ",", "\"\<,\>\""}], "]"}], 
               ",", "\"\<'\>\""}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"StringSplit", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"StringSplit", "[", 
                 RowBox[{
                  RowBox[{"StringSplit", "[", 
                   RowBox[{
                    RowBox[{"StringTrim", "[", 
                    RowBox[{
                    RowBox[{"StringTrim", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"StringSplit", "[", 
                    RowBox[{
                    RowBox[{"DataSet", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<, [\>\""}], 
                    "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<[\>\""}], "]"}],
                     ",", "\"\<]\>\""}], "]"}], ",", "\"\<,\>\""}], "]"}], 
                  ",", "\"\<'\>\""}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", "\"\<C\>\""}], 
              "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"c", "=", 
          RowBox[{"StringReplace", "[", 
           RowBox[{
            RowBox[{"StringTrim", "[", 
             RowBox[{
              RowBox[{"StringTrim", "[", 
               RowBox[{
                RowBox[{"StringSplit", "[", 
                 RowBox[{
                  RowBox[{"DataSet", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<, [\>\""}], 
                 "]"}], "[", 
                RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", "\"\<]]\>\""}], 
             "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"\"\<(\>\"", "->", "\"\<[\>\""}], ",", 
              RowBox[{"\"\<)\>\"", "->", "\"\<]\>\""}]}], "}"}]}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"c", "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"StringContainsQ", "[", 
             RowBox[{"c", ",", "\"\<e\>\""}], "]"}], ",", 
            RowBox[{
             RowBox[{"d", "=", 
              RowBox[{"StringSplit", "[", 
               RowBox[{"c", ",", "\"\<e\>\""}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"ToExpression", "[", 
               RowBox[{"d", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], "*", 
              RowBox[{"10", "^", 
               RowBox[{"ToExpression", "[", 
                RowBox[{"d", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "]"}]}]}]}], ",", 
            RowBox[{"ToExpression", "[", "c", "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"a", "=", 
          RowBox[{"ReplaceAll", "[", 
           RowBox[{"a", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"0", "->", "q1"}], ",", 
              RowBox[{"1", "->", "q2"}]}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "a", "]"}], "==", "2"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"StringContainsQ", "[", 
              RowBox[{"b", ",", "\"\<SWAP\>\""}], "]"}], ",", 
             RowBox[{"Subscript", "[", 
              RowBox[{
               RowBox[{"ToExpression", "[", "SWAP", "]"}], ",", 
               RowBox[{"a", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{"a", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"TwoQ", ",", 
               RowBox[{"Subscript", "[", 
                RowBox[{"CZARPPar", ",", 
                 RowBox[{"a", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", 
                 RowBox[{"a", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", "TwoQ"}], 
              "}"}]}], "]"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"c", "===", 
              RowBox[{"{", "}"}]}], ",", 
             RowBox[{"Subscript", "[", 
              RowBox[{
               RowBox[{"ToExpression", "[", "b", "]"}], ",", 
               RowBox[{"a", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
             RowBox[{
              RowBox[{"Subscript", "[", 
               RowBox[{
                RowBox[{"ToExpression", "[", "b", "]"}], ",", 
                RowBox[{"a", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "[", "c", "]"}]}], 
            "]"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "DataSet", "]"}]}], "}"}]}], "]"}], "]"}], 
     ",", 
     RowBox[{"{", "TwoQ", "}"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SU4GatePIParMove", "[", 
    RowBox[{"DataSet_", ",", "q1_", ",", "q2_"}], "]"}], ":=", 
   RowBox[{"SequenceSplit", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"a", "=", 
          RowBox[{"Reverse", "[", 
           RowBox[{"IntegerPart", "[", 
            RowBox[{"ToExpression", "[", 
             RowBox[{"StringSplit", "[", 
              RowBox[{
               RowBox[{"StringTrim", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"StringSplit", "[", 
                   RowBox[{
                    RowBox[{"DataSet", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<, [\>\""}], 
                   "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", "\"\<]\>\""}], "]"}], 
               ",", "\"\<,\>\""}], "]"}], "]"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"b", "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "a", "]"}], "==", "1"}], ",", 
            RowBox[{
             RowBox[{"StringSplit", "[", 
              RowBox[{
               RowBox[{"StringSplit", "[", 
                RowBox[{
                 RowBox[{"StringTrim", "[", 
                  RowBox[{
                   RowBox[{"StringTrim", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"StringSplit", "[", 
                    RowBox[{
                    RowBox[{"DataSet", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<, [\>\""}], 
                    "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<[\>\""}], "]"}],
                    ",", "\"\<]\>\""}], "]"}], ",", "\"\<,\>\""}], "]"}], 
               ",", "\"\<'\>\""}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"StringSplit", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"StringSplit", "[", 
                 RowBox[{
                  RowBox[{"StringSplit", "[", 
                   RowBox[{
                    RowBox[{"StringTrim", "[", 
                    RowBox[{
                    RowBox[{"StringTrim", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"StringSplit", "[", 
                    RowBox[{
                    RowBox[{"DataSet", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<, [\>\""}], 
                    "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<[\>\""}], "]"}],
                     ",", "\"\<]\>\""}], "]"}], ",", "\"\<,\>\""}], "]"}], 
                  ",", "\"\<'\>\""}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", "\"\<C\>\""}], 
              "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"c", "=", 
          RowBox[{"StringReplace", "[", 
           RowBox[{
            RowBox[{"StringTrim", "[", 
             RowBox[{
              RowBox[{"StringTrim", "[", 
               RowBox[{
                RowBox[{"StringSplit", "[", 
                 RowBox[{
                  RowBox[{"DataSet", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<, [\>\""}], 
                 "]"}], "[", 
                RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", "\"\<]]\>\""}], 
             "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"\"\<(\>\"", "->", "\"\<[\>\""}], ",", 
              RowBox[{"\"\<)\>\"", "->", "\"\<]\>\""}]}], "}"}]}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"c", "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"StringContainsQ", "[", 
             RowBox[{"c", ",", "\"\<e\>\""}], "]"}], ",", 
            RowBox[{
             RowBox[{"d", "=", 
              RowBox[{"StringSplit", "[", 
               RowBox[{"c", ",", "\"\<e\>\""}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"ToExpression", "[", 
               RowBox[{"d", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], "*", 
              RowBox[{"10", "^", 
               RowBox[{"ToExpression", "[", 
                RowBox[{"d", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "]"}]}]}]}], ",", 
            RowBox[{"ToExpression", "[", "c", "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"a", "=", 
          RowBox[{"ReplaceAll", "[", 
           RowBox[{"a", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"0", "->", "q1"}], ",", 
              RowBox[{"1", "->", "q2"}]}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "a", "]"}], "==", "2"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"StringContainsQ", "[", 
              RowBox[{"b", ",", "\"\<SWAP\>\""}], "]"}], ",", 
             RowBox[{"Subscript", "[", 
              RowBox[{
               RowBox[{"ToExpression", "[", "SWAP", "]"}], ",", 
               RowBox[{"a", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{"a", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"TwoQ", ",", 
               RowBox[{"Subscript", "[", 
                RowBox[{"CZPIPar", ",", 
                 RowBox[{"a", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", 
                 RowBox[{"a", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", "TwoQ"}], 
              "}"}]}], "]"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"c", "===", 
              RowBox[{"{", "}"}]}], ",", 
             RowBox[{"Subscript", "[", 
              RowBox[{
               RowBox[{"ToExpression", "[", "b", "]"}], ",", 
               RowBox[{"a", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
             RowBox[{
              RowBox[{"Subscript", "[", 
               RowBox[{
                RowBox[{"ToExpression", "[", "b", "]"}], ",", 
                RowBox[{"a", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "[", "c", "]"}]}], 
            "]"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "DataSet", "]"}]}], "}"}]}], "]"}], "]"}], 
     ",", 
     RowBox[{"{", "TwoQ", "}"}]}], "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Fully", " ", "Translate", " ", "Qiskit", " ", "output", " ", "into", 
      " ", "QuEST", " ", "format"}], ",", " ", 
     RowBox[{"SWAP", " ", "Procedure"}], ",", " ", 
     RowBox[{"ARP", " ", "CZ"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SU4GateDCARP", "[", 
     RowBox[{"DataSet_", ",", "q1_", ",", "q2_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"a", "=", 
          RowBox[{"Reverse", "[", 
           RowBox[{"IntegerPart", "[", 
            RowBox[{"ToExpression", "[", 
             RowBox[{"StringSplit", "[", 
              RowBox[{
               RowBox[{"StringTrim", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"StringSplit", "[", 
                   RowBox[{
                    RowBox[{"DataSet", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<, [\>\""}], 
                   "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", "\"\<]\>\""}], "]"}], 
               ",", "\"\<,\>\""}], "]"}], "]"}], "]"}], "]"}]}], ";", 
         RowBox[{"b", "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "a", "]"}], "==", "1"}], ",", 
            RowBox[{
             RowBox[{"StringSplit", "[", 
              RowBox[{
               RowBox[{"StringSplit", "[", 
                RowBox[{
                 RowBox[{"StringTrim", "[", 
                  RowBox[{
                   RowBox[{"StringTrim", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"StringSplit", "[", 
                    RowBox[{
                    RowBox[{"DataSet", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<, [\>\""}], 
                    "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<[\>\""}], "]"}],
                    ",", "\"\<]\>\""}], "]"}], ",", "\"\<,\>\""}], "]"}], 
               ",", "\"\<'\>\""}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"StringSplit", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"StringSplit", "[", 
                 RowBox[{
                  RowBox[{"StringSplit", "[", 
                   RowBox[{
                    RowBox[{"StringTrim", "[", 
                    RowBox[{
                    RowBox[{"StringTrim", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"StringSplit", "[", 
                    RowBox[{
                    RowBox[{"DataSet", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<, [\>\""}], 
                    "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<[\>\""}], "]"}],
                     ",", "\"\<]\>\""}], "]"}], ",", "\"\<,\>\""}], "]"}], 
                  ",", "\"\<'\>\""}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", "\"\<C\>\""}], 
              "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"c", "=", 
          RowBox[{"StringReplace", "[", 
           RowBox[{
            RowBox[{"StringTrim", "[", 
             RowBox[{
              RowBox[{"StringTrim", "[", 
               RowBox[{
                RowBox[{"StringSplit", "[", 
                 RowBox[{
                  RowBox[{"DataSet", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<, [\>\""}], 
                 "]"}], "[", 
                RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", "\"\<]]\>\""}], 
             "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"\"\<(\>\"", "->", "\"\<[\>\""}], ",", 
              RowBox[{"\"\<)\>\"", "->", "\"\<]\>\""}]}], "}"}]}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"c", "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"StringContainsQ", "[", 
             RowBox[{"c", ",", "\"\<e\>\""}], "]"}], ",", 
            RowBox[{
             RowBox[{"d", "=", 
              RowBox[{"StringSplit", "[", 
               RowBox[{"c", ",", "\"\<e\>\""}], "]"}]}], ";", 
             RowBox[{
              RowBox[{"ToExpression", "[", 
               RowBox[{"d", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], "*", 
              SuperscriptBox["10", 
               RowBox[{"ToExpression", "[", 
                RowBox[{"d", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "]"}]]}]}], ",", 
            RowBox[{"ToExpression", "[", "c", "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"a", "=", 
          RowBox[{"ReplaceAll", "[", 
           RowBox[{"a", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"0", "->", "q1"}], ",", 
              RowBox[{"1", "->", "q2"}]}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "a", "]"}], "==", "2"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"StringContainsQ", "[", 
              RowBox[{"b", ",", "\"\<SWAP\>\""}], "]"}], ",", 
             SubscriptBox[
              RowBox[{"ToExpression", "[", "SWAPDCARP", "]"}], 
              RowBox[{
               RowBox[{"a", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{"a", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}]], ",", 
             SubscriptBox["CZARP", 
              RowBox[{
               RowBox[{"a", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", 
               RowBox[{"a", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}]]}], "]"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"c", "===", 
              RowBox[{"{", "}"}]}], ",", 
             SubscriptBox[
              RowBox[{"ToExpression", "[", "b", "]"}], 
              RowBox[{"a", "[", 
               RowBox[{"[", "1", "]"}], "]"}]], ",", 
             RowBox[{
              SubscriptBox[
               RowBox[{"ToExpression", "[", "b", "]"}], 
               RowBox[{"a", "[", 
                RowBox[{"[", "1", "]"}], "]"}]], "[", "c", "]"}]}], "]"}]}], 
          "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "DataSet", "]"}]}], "}"}]}], "]"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "Fully", " ", "Translate", " ", "Qiskit", " ", "output", " ", "into", 
         " ", "QuEST", " ", "format"}], ",", " ", 
        RowBox[{"SWAP", " ", "Procedure"}], ",", " ", 
        RowBox[{"GA", " ", "CZ"}]}], "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"SU4GateDCPI", "[", 
       RowBox[{"DataSet_", ",", "q1_", ",", "q2_"}], "]"}]}], ":=", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"a", "=", 
         RowBox[{"Reverse", "[", 
          RowBox[{"IntegerPart", "[", 
           RowBox[{"ToExpression", "[", 
            RowBox[{"StringSplit", "[", 
             RowBox[{
              RowBox[{"StringTrim", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"StringSplit", "[", 
                  RowBox[{
                   RowBox[{"DataSet", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<, [\>\""}], 
                  "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ",", "\"\<]\>\""}], "]"}], 
              ",", "\"\<,\>\""}], "]"}], "]"}], "]"}], "]"}]}], ";", 
        RowBox[{"b", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "a", "]"}], "==", "1"}], ",", 
           RowBox[{
            RowBox[{"StringSplit", "[", 
             RowBox[{
              RowBox[{"StringSplit", "[", 
               RowBox[{
                RowBox[{"StringTrim", "[", 
                 RowBox[{
                  RowBox[{"StringTrim", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringSplit", "[", 
                    RowBox[{
                    RowBox[{"DataSet", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<, [\>\""}], 
                    "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<[\>\""}], "]"}],
                   ",", "\"\<]\>\""}], "]"}], ",", "\"\<,\>\""}], "]"}], ",", 
              "\"\<'\>\""}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{"StringSplit", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"StringSplit", "[", 
                RowBox[{
                 RowBox[{"StringSplit", "[", 
                  RowBox[{
                   RowBox[{"StringTrim", "[", 
                    RowBox[{
                    RowBox[{"StringTrim", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"StringSplit", "[", 
                    RowBox[{
                    RowBox[{"DataSet", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<, [\>\""}], 
                    "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<[\>\""}], "]"}],
                     ",", "\"\<]\>\""}], "]"}], ",", "\"\<,\>\""}], "]"}], 
                 ",", "\"\<'\>\""}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", "\"\<C\>\""}], 
             "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"c", "=", 
         RowBox[{"StringReplace", "[", 
          RowBox[{
           RowBox[{"StringTrim", "[", 
            RowBox[{
             RowBox[{"StringTrim", "[", 
              RowBox[{
               RowBox[{"StringSplit", "[", 
                RowBox[{
                 RowBox[{"DataSet", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<, [\>\""}], "]"}],
                "[", 
               RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", "\"\<]]\>\""}], 
            "]"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\"\<(\>\"", "->", "\"\<[\>\""}], ",", 
             RowBox[{"\"\<)\>\"", "->", "\"\<]\>\""}]}], "}"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"c", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"StringContainsQ", "[", 
            RowBox[{"c", ",", "\"\<e\>\""}], "]"}], ",", 
           RowBox[{
            RowBox[{"d", "=", 
             RowBox[{"StringSplit", "[", 
              RowBox[{"c", ",", "\"\<e\>\""}], "]"}]}], ";", 
            RowBox[{
             RowBox[{"ToExpression", "[", 
              RowBox[{"d", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], "*", 
             SuperscriptBox["10", 
              RowBox[{"ToExpression", "[", 
               RowBox[{"d", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}]]}]}], ",", 
           RowBox[{"ToExpression", "[", "c", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"a", "=", 
         RowBox[{"ReplaceAll", "[", 
          RowBox[{"a", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"0", "->", "q1"}], ",", 
             RowBox[{"1", "->", "q2"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "a", "]"}], "==", "2"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"StringContainsQ", "[", 
             RowBox[{"b", ",", "\"\<SWAP\>\""}], "]"}], ",", 
            SubscriptBox[
             RowBox[{"ToExpression", "[", "SWAPDCPI", "]"}], 
             RowBox[{
              RowBox[{"a", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"a", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}]], ",", 
            SubscriptBox["CZPI", 
             RowBox[{
              RowBox[{"a", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", 
              RowBox[{"a", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}]]}], "]"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"c", "===", 
             RowBox[{"{", "}"}]}], ",", 
            SubscriptBox[
             RowBox[{"ToExpression", "[", "b", "]"}], 
             RowBox[{"a", "[", 
              RowBox[{"[", "1", "]"}], "]"}]], ",", 
            RowBox[{
             SubscriptBox[
              RowBox[{"ToExpression", "[", "b", "]"}], 
              RowBox[{"a", "[", 
               RowBox[{"[", "1", "]"}], "]"}]], "[", "c", "]"}]}], "]"}]}], 
         "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "DataSet", "]"}]}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Parallelised", " ", "SU4", " ", "Gate", " ", "layer", " ", "generators"}],
    "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SU4GateDCARP", "[", 
    RowBox[{"DataSet_", ",", "q1_", ",", "q2_"}], "]"}], ":=", 
   RowBox[{"SequenceSplit", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"a", "=", 
          RowBox[{"Reverse", "[", 
           RowBox[{"IntegerPart", "[", 
            RowBox[{"ToExpression", "[", 
             RowBox[{"StringSplit", "[", 
              RowBox[{
               RowBox[{"StringTrim", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"StringSplit", "[", 
                   RowBox[{
                    RowBox[{"DataSet", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<, [\>\""}], 
                   "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", "\"\<]\>\""}], "]"}], 
               ",", "\"\<,\>\""}], "]"}], "]"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"b", "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "a", "]"}], "==", "1"}], ",", 
            RowBox[{
             RowBox[{"StringSplit", "[", 
              RowBox[{
               RowBox[{"StringSplit", "[", 
                RowBox[{
                 RowBox[{"StringTrim", "[", 
                  RowBox[{
                   RowBox[{"StringTrim", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"StringSplit", "[", 
                    RowBox[{
                    RowBox[{"DataSet", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<, [\>\""}], 
                    "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<[\>\""}], "]"}],
                    ",", "\"\<]\>\""}], "]"}], ",", "\"\<,\>\""}], "]"}], 
               ",", "\"\<'\>\""}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"StringSplit", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"StringSplit", "[", 
                 RowBox[{
                  RowBox[{"StringSplit", "[", 
                   RowBox[{
                    RowBox[{"StringTrim", "[", 
                    RowBox[{
                    RowBox[{"StringTrim", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"StringSplit", "[", 
                    RowBox[{
                    RowBox[{"DataSet", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<, [\>\""}], 
                    "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<[\>\""}], "]"}],
                     ",", "\"\<]\>\""}], "]"}], ",", "\"\<,\>\""}], "]"}], 
                  ",", "\"\<'\>\""}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", "\"\<C\>\""}], 
              "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"c", "=", 
          RowBox[{"StringReplace", "[", 
           RowBox[{
            RowBox[{"StringTrim", "[", 
             RowBox[{
              RowBox[{"StringTrim", "[", 
               RowBox[{
                RowBox[{"StringSplit", "[", 
                 RowBox[{
                  RowBox[{"DataSet", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<, [\>\""}], 
                 "]"}], "[", 
                RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", "\"\<]]\>\""}], 
             "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"\"\<(\>\"", "->", "\"\<[\>\""}], ",", 
              RowBox[{"\"\<)\>\"", "->", "\"\<]\>\""}]}], "}"}]}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"c", "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"StringContainsQ", "[", 
             RowBox[{"c", ",", "\"\<e\>\""}], "]"}], ",", 
            RowBox[{
             RowBox[{"d", "=", 
              RowBox[{"StringSplit", "[", 
               RowBox[{"c", ",", "\"\<e\>\""}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"ToExpression", "[", 
               RowBox[{"d", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], "*", 
              RowBox[{"10", "^", 
               RowBox[{"ToExpression", "[", 
                RowBox[{"d", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "]"}]}]}]}], ",", 
            RowBox[{"ToExpression", "[", "c", "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"a", "=", 
          RowBox[{"ReplaceAll", "[", 
           RowBox[{"a", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"0", "->", "q1"}], ",", 
              RowBox[{"1", "->", "q2"}]}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "a", "]"}], "==", "2"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"StringContainsQ", "[", 
              RowBox[{"b", ",", "\"\<SWAP\>\""}], "]"}], ",", 
             RowBox[{"Subscript", "[", 
              RowBox[{
               RowBox[{"ToExpression", "[", "SWAP", "]"}], ",", 
               RowBox[{"a", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{"a", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"TwoQ", ",", 
               RowBox[{"Subscript", "[", 
                RowBox[{"CZARP", ",", 
                 RowBox[{"a", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", 
                 RowBox[{"a", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", "TwoQ"}], 
              "}"}]}], "]"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"c", "===", 
              RowBox[{"{", "}"}]}], ",", 
             RowBox[{"Subscript", "[", 
              RowBox[{
               RowBox[{"ToExpression", "[", "b", "]"}], ",", 
               RowBox[{"a", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
             RowBox[{
              RowBox[{"Subscript", "[", 
               RowBox[{
                RowBox[{"ToExpression", "[", "b", "]"}], ",", 
                RowBox[{"a", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "[", "c", "]"}]}], 
            "]"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "DataSet", "]"}]}], "}"}]}], "]"}], "]"}], 
     ",", 
     RowBox[{"{", "TwoQ", "}"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SU4GateDCPI", "[", 
   RowBox[{"DataSet_", ",", "q1_", ",", "q2_"}], "]"}], ":=", 
  RowBox[{"SequenceSplit", "[", 
   RowBox[{
    RowBox[{"Flatten", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"a", "=", 
         RowBox[{"Reverse", "[", 
          RowBox[{"IntegerPart", "[", 
           RowBox[{"ToExpression", "[", 
            RowBox[{"StringSplit", "[", 
             RowBox[{
              RowBox[{"StringTrim", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"StringSplit", "[", 
                  RowBox[{
                   RowBox[{"DataSet", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<, [\>\""}], 
                  "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ",", "\"\<]\>\""}], "]"}], 
              ",", "\"\<,\>\""}], "]"}], "]"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"b", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "a", "]"}], "==", "1"}], ",", 
           RowBox[{
            RowBox[{"StringSplit", "[", 
             RowBox[{
              RowBox[{"StringSplit", "[", 
               RowBox[{
                RowBox[{"StringTrim", "[", 
                 RowBox[{
                  RowBox[{"StringTrim", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringSplit", "[", 
                    RowBox[{
                    RowBox[{"DataSet", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<, [\>\""}], 
                    "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<[\>\""}], "]"}],
                   ",", "\"\<]\>\""}], "]"}], ",", "\"\<,\>\""}], "]"}], ",", 
              "\"\<'\>\""}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{"StringSplit", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"StringSplit", "[", 
                RowBox[{
                 RowBox[{"StringSplit", "[", 
                  RowBox[{
                   RowBox[{"StringTrim", "[", 
                    RowBox[{
                    RowBox[{"StringTrim", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"StringSplit", "[", 
                    RowBox[{
                    RowBox[{"DataSet", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<, [\>\""}], 
                    "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<[\>\""}], "]"}],
                     ",", "\"\<]\>\""}], "]"}], ",", "\"\<,\>\""}], "]"}], 
                 ",", "\"\<'\>\""}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", "\"\<C\>\""}], 
             "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"c", "=", 
         RowBox[{"StringReplace", "[", 
          RowBox[{
           RowBox[{"StringTrim", "[", 
            RowBox[{
             RowBox[{"StringTrim", "[", 
              RowBox[{
               RowBox[{"StringSplit", "[", 
                RowBox[{
                 RowBox[{"DataSet", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<, [\>\""}], "]"}],
                "[", 
               RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", "\"\<]]\>\""}], 
            "]"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\"\<(\>\"", "->", "\"\<[\>\""}], ",", 
             RowBox[{"\"\<)\>\"", "->", "\"\<]\>\""}]}], "}"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"c", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"StringContainsQ", "[", 
            RowBox[{"c", ",", "\"\<e\>\""}], "]"}], ",", 
           RowBox[{
            RowBox[{"d", "=", 
             RowBox[{"StringSplit", "[", 
              RowBox[{"c", ",", "\"\<e\>\""}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ToExpression", "[", 
              RowBox[{"d", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], "*", 
             RowBox[{"10", "^", 
              RowBox[{"ToExpression", "[", 
               RowBox[{"d", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}]}]}]}], ",", 
           RowBox[{"ToExpression", "[", "c", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"a", "=", 
         RowBox[{"ReplaceAll", "[", 
          RowBox[{"a", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"0", "->", "q1"}], ",", 
             RowBox[{"1", "->", "q2"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "a", "]"}], "==", "2"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"StringContainsQ", "[", 
             RowBox[{"b", ",", "\"\<SWAP\>\""}], "]"}], ",", 
            RowBox[{"Subscript", "[", 
             RowBox[{
              RowBox[{"ToExpression", "[", "SWAP", "]"}], ",", 
              RowBox[{"a", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"a", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"TwoQ", ",", 
              RowBox[{"Subscript", "[", 
               RowBox[{"CZPI", ",", 
                RowBox[{"a", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ",", 
                RowBox[{"a", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", "TwoQ"}], 
             "}"}]}], "]"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"c", "===", 
             RowBox[{"{", "}"}]}], ",", 
            RowBox[{"Subscript", "[", 
             RowBox[{
              RowBox[{"ToExpression", "[", "b", "]"}], ",", 
              RowBox[{"a", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
            RowBox[{
             RowBox[{"Subscript", "[", 
              RowBox[{
               RowBox[{"ToExpression", "[", "b", "]"}], ",", 
               RowBox[{"a", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "[", "c", "]"}]}], 
           "]"}]}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "DataSet", "]"}]}], "}"}]}], "]"}], "]"}], 
    ",", 
    RowBox[{"{", "TwoQ", "}"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{
  3.9053160891152782`*^9, {3.9053187312456446`*^9, 3.905318731461608*^9}, {
   3.9053189120048704`*^9, 3.90531891240794*^9}, {3.9055045425967155`*^9, 
   3.9055046020173655`*^9}},
 CellLabel->
  "In[589]:=",ExpressionUUID->"160f339b-1ccf-4ffa-b529-a53ed265e97a"],

Cell[BoxData["5"], "Output",
 CellChangeTimes->{3.904979506015484*^9, 3.904980169606222*^9, 
  3.9049819522938476`*^9, 3.9049820977273664`*^9, 3.9049823304053288`*^9, 
  3.904982582438953*^9, 3.9049830915434203`*^9, 3.9053169261504226`*^9, 
  3.9053189134363346`*^9, 3.905319210209654*^9, 3.905325551644539*^9, 
  3.905329443813427*^9, 3.9054817168373384`*^9, 3.9055046059435053`*^9, 
  3.9055075883285155`*^9, 3.9055102956364107`*^9, 3.9055103857027593`*^9},
 CellLabel->
  "Out[589]=",ExpressionUUID->"9b4f7bf4-cd85-403c-9eb7-06e715af0e5d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "1", ",", "2", ",", "3", ",", "4"}], "}"}]], "Output",
 CellChangeTimes->{3.904979506015484*^9, 3.904980169606222*^9, 
  3.9049819522938476`*^9, 3.9049820977273664`*^9, 3.9049823304053288`*^9, 
  3.904982582438953*^9, 3.9049830915434203`*^9, 3.9053169261504226`*^9, 
  3.9053189134363346`*^9, 3.905319210209654*^9, 3.905325551644539*^9, 
  3.905329443813427*^9, 3.9054817168373384`*^9, 3.9055046059435053`*^9, 
  3.9055075883285155`*^9, 3.9055102956364107`*^9, 3.905510385710298*^9},
 CellLabel->
  "Out[590]=",ExpressionUUID->"b337576f-be84-435d-a207-1e10b8fbb786"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"QVLayerARPMove", "[", 
     RowBox[{"DataSet_", ",", "NQ_", ",", "RQs_", ",", "i_"}], "]"}], ":=", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"SU4GateARPMove", "[", 
         RowBox[{
          RowBox[{"DataSet", "[", 
           RowBox[{"[", 
            RowBox[{"n", "-", 
             RowBox[{"Quotient", "[", 
              RowBox[{"n", ",", "2"}], "]"}], "+", "i"}], "]"}], "]"}], ",", 
          RowBox[{"RQs", "[", 
           RowBox[{"[", "n", "]"}], "]"}], ",", 
          RowBox[{"RQs", "[", 
           RowBox[{"[", 
            RowBox[{"n", "+", "1"}], "]"}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"n", ",", "1", ",", 
          RowBox[{"2", "*", 
           RowBox[{"Quotient", "[", 
            RowBox[{"NQ", ",", "2"}], "]"}]}], ",", "2"}], "}"}]}], "]"}], 
      ",", "2"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"QVLayerPIMove", "[", 
     RowBox[{"DataSet_", ",", "NQ_", ",", "RQs_", ",", "i_"}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"SU4GatePIMove", "[", 
         RowBox[{
          RowBox[{"DataSet", "[", 
           RowBox[{"[", 
            RowBox[{"n", "-", 
             RowBox[{"Quotient", "[", 
              RowBox[{"n", ",", "2"}], "]"}], "+", "i"}], "]"}], "]"}], ",", 
          RowBox[{"RQs", "[", 
           RowBox[{"[", "n", "]"}], "]"}], ",", 
          RowBox[{"RQs", "[", 
           RowBox[{"[", 
            RowBox[{"n", "+", "1"}], "]"}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"n", ",", "1", ",", 
          RowBox[{"2", "*", 
           RowBox[{"Quotient", "[", 
            RowBox[{"NQ", ",", "2"}], "]"}]}], ",", "2"}], "}"}]}], "]"}], 
      ",", "2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"QVLayerARPParMove", "[", 
    RowBox[{"DataSet_", ",", "NQ_", ",", "RQs_", ",", "i_"}], "]"}], ":=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"SU4S", "=", 
         RowBox[{"Join", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"SU4GateARPParMove", "[", 
             RowBox[{
              RowBox[{"DataSet", "[", 
               RowBox[{"[", 
                RowBox[{"n", "-", 
                 RowBox[{"Quotient", "[", 
                  RowBox[{"n", ",", "2"}], "]"}], "+", "i"}], "]"}], "]"}], 
              ",", 
              RowBox[{"RQs", "[", 
               RowBox[{"[", "n", "]"}], "]"}], ",", 
              RowBox[{"RQs", "[", 
               RowBox[{"[", 
                RowBox[{"n", "+", "1"}], "]"}], "]"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"n", ",", "1", ",", 
              RowBox[{"2", "*", 
               RowBox[{"Quotient", "[", 
                RowBox[{"NQ", ",", "2"}], "]"}]}], ",", "2"}], "}"}]}], "]"}],
           "]"}]}], ";", 
        RowBox[{"Join", "[", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"OddQ", "[", "j", "]"}], ",", 
           RowBox[{"CircRydbergHub", "[", 
            RowBox[{
             RowBox[{"Flatten", "[", 
              RowBox[{"SU4S", "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "j"}], "]"}], "]"}], "]"}], ",", "RydDev",
              ",", 
             RowBox[{"Parallel", "->", "True"}]}], "]"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"OddQ", "[", "NQ", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"Flatten", "[", 
               RowBox[{"Append", "[", 
                RowBox[{
                 RowBox[{"SU4S", "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", "j"}], "]"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   SubscriptBox["SpareARP", 
                    RowBox[{"RQs", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}]], ",", 
                   RowBox[{
                    SubscriptBox["Wait", "0"], "[", "MoveTime", "]"}]}], 
                  "}"}]}], "]"}], "]"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"Flatten", "[", 
               RowBox[{"SU4S", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "j"}], "]"}], "]"}], "]"}], "}"}]}], 
            "]"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "7"}], "}"}]}], "]"}], ",", "1"}], 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"QVLayerPIParMove", "[", 
     RowBox[{"DataSet_", ",", "NQ_", ",", "RQs_", ",", "i_"}], "]"}], ":=", 
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"SU4S", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"SU4GatePIParMove", "[", 
              RowBox[{
               RowBox[{"DataSet", "[", 
                RowBox[{"[", 
                 RowBox[{"n", "-", 
                  RowBox[{"Quotient", "[", 
                   RowBox[{"n", ",", "2"}], "]"}], "+", "i"}], "]"}], "]"}], 
               ",", 
               RowBox[{"RQs", "[", 
                RowBox[{"[", "n", "]"}], "]"}], ",", 
               RowBox[{"RQs", "[", 
                RowBox[{"[", 
                 RowBox[{"n", "+", "1"}], "]"}], "]"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"n", ",", "1", ",", 
               RowBox[{"2", "*", 
                RowBox[{"Quotient", "[", 
                 RowBox[{"NQ", ",", "2"}], "]"}]}], ",", "2"}], "}"}]}], 
            "]"}], "]"}]}], ";", 
         RowBox[{"Join", "[", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"OddQ", "[", "j", "]"}], ",", 
            RowBox[{"CircRydbergHub", "[", 
             RowBox[{
              RowBox[{"Flatten", "[", 
               RowBox[{"SU4S", "[", 
                RowBox[{"[", 
                 RowBox[{"All", ",", "j"}], "]"}], "]"}], "]"}], ",", 
              "RydDev", ",", 
              RowBox[{"Parallel", "->", "True"}]}], "]"}], ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"OddQ", "[", "NQ", "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"Flatten", "[", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"SU4S", "[", 
                   RowBox[{"[", 
                    RowBox[{"All", ",", "j"}], "]"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    SubscriptBox["SparePI", 
                    RowBox[{"RQs", "[", 
                    RowBox[{"[", 
                    RowBox[{"-", "1"}], "]"}], "]"}]], ",", 
                    RowBox[{
                    SubscriptBox["Wait", "0"], "[", "MoveTime", "]"}]}], 
                   "}"}]}], "]"}], "]"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"Flatten", "[", 
                RowBox[{"SU4S", "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", "j"}], "]"}], "]"}], "]"}], "}"}]}], 
             "]"}]}], "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "7"}], "}"}]}], "]"}], ",", "1"}], 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"QVLayerARPPropSWAP", "[", 
    RowBox[{
    "DataSet_", ",", "NQ_", ",", "RQs_", ",", "i_", ",", "LocTracker_"}], 
    "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", 
     RowBox[{
      RowBox[{"LocTrackerARP", "=", "LocTracker"}], " ", ";", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"QLoclist", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"LocTrackerARP", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"RQs", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "+", "1"}], "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", "NQ"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"GateOrdering", "=", 
          RowBox[{
           RowBox[{"SortBy", "[", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"EvenQ", "[", 
                   RowBox[{
                    RowBox[{"QLoclist", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "-", 
                    RowBox[{"QLoclist", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", "+", "1"}], "]"}], "]"}]}], "]"}], "&&", " ", 
                  RowBox[{
                   RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{"QLoclist", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "-", 
                    RowBox[{"QLoclist", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", "+", "1"}], "]"}], "]"}]}], "]"}], "==", 
                   "2"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"j", "-", 
                    RowBox[{"Quotient", "[", 
                    RowBox[{"j", ",", "2"}], "]"}]}], ",", "0"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"j", "-", 
                    RowBox[{"Quotient", "[", 
                    RowBox[{"j", ",", "2"}], "]"}]}], ",", 
                   RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{"QLoclist", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "-", 
                    RowBox[{"QLoclist", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", "+", "1"}], "]"}], "]"}]}], "]"}]}], "}"}]}],
                 "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", "1", ",", 
                 RowBox[{
                  RowBox[{"Length", "[", "QLoclist", "]"}], "-", "1"}], ",", 
                 "2"}], "}"}]}], "]"}], ",", "Last"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"RQSOrd", "=", 
          RowBox[{"Flatten", "[", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"RQs", "[", 
              RowBox[{"[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"2", "*", 
                   RowBox[{"GateOrdering", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "-", "1"}], ",", 
                 RowBox[{"2", "*", 
                  RowBox[{"GateOrdering", "[", 
                   RowBox[{"[", "j", "]"}], "]"}]}]}], "}"}], "]"}], "]"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "1", ",", 
               RowBox[{"Length", "[", "GateOrdering", "]"}]}], "}"}]}], "]"}],
            "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"OutSlice", "=", 
          RowBox[{"SWAPScheduleARP", "[", 
           RowBox[{
            RowBox[{"DataSet", "[", 
             RowBox[{"[", 
              RowBox[{"n", "-", 
               RowBox[{"Quotient", "[", 
                RowBox[{"n", ",", "2"}], "]"}], "+", "i"}], "]"}], "]"}], ",", 
            RowBox[{"RQSOrd", "[", 
             RowBox[{"[", "n", "]"}], "]"}], ",", 
            RowBox[{"RQSOrd", "[", 
             RowBox[{"[", 
              RowBox[{"n", "+", "1"}], "]"}], "]"}], ",", "LocTrackerARP"}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"LocTrackerARP", "=", 
          RowBox[{"OutSlice", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         "OutSlice"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"n", ",", "1", ",", 
          RowBox[{"2", "*", 
           RowBox[{"Quotient", "[", 
            RowBox[{"NQ", ",", "2"}], "]"}]}], ",", "2"}], "}"}]}], "]"}]}]}],
     "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"QVLayerPIPropSWAP", "[", 
   RowBox[{
   "DataSet_", ",", "NQ_", ",", "RQs_", ",", "i_", ",", "LocTracker_"}], 
   "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", 
    RowBox[{
     RowBox[{"LocTrackerPI", "=", "LocTracker"}], " ", ";", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"QLoclist", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"LocTrackerPI", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"RQs", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "+", "1"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "NQ"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"GateOrdering", "=", 
         RowBox[{
          RowBox[{"SortBy", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"EvenQ", "[", 
                  RowBox[{
                   RowBox[{"QLoclist", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "-", 
                   RowBox[{"QLoclist", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", "+", "1"}], "]"}], "]"}]}], "]"}], "&&", " ", 
                 RowBox[{
                  RowBox[{"Abs", "[", 
                   RowBox[{
                    RowBox[{"QLoclist", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "-", 
                    RowBox[{"QLoclist", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", "+", "1"}], "]"}], "]"}]}], "]"}], "==", 
                  "2"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"j", "-", 
                   RowBox[{"Quotient", "[", 
                    RowBox[{"j", ",", "2"}], "]"}]}], ",", "0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"j", "-", 
                   RowBox[{"Quotient", "[", 
                    RowBox[{"j", ",", "2"}], "]"}]}], ",", 
                  RowBox[{"Abs", "[", 
                   RowBox[{
                    RowBox[{"QLoclist", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "-", 
                    RowBox[{"QLoclist", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", "+", "1"}], "]"}], "]"}]}], "]"}]}], "}"}]}],
                "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "1", ",", 
                RowBox[{
                 RowBox[{"Length", "[", "QLoclist", "]"}], "-", "1"}], ",", 
                "2"}], "}"}]}], "]"}], ",", "Last"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"RQSOrd", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"RQs", "[", 
             RowBox[{"[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"2", "*", 
                  RowBox[{"GateOrdering", "[", 
                   RowBox[{"[", "j", "]"}], "]"}]}], "-", "1"}], ",", 
                RowBox[{"2", "*", 
                 RowBox[{"GateOrdering", "[", 
                  RowBox[{"[", "j", "]"}], "]"}]}]}], "}"}], "]"}], "]"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", 
              RowBox[{"Length", "[", "GateOrdering", "]"}]}], "}"}]}], "]"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"OutSlice", "=", 
         RowBox[{"SWAPSchedulePI", "[", 
          RowBox[{
           RowBox[{"DataSet", "[", 
            RowBox[{"[", 
             RowBox[{"n", "-", 
              RowBox[{"Quotient", "[", 
               RowBox[{"n", ",", "2"}], "]"}], "+", "i"}], "]"}], "]"}], ",", 
           RowBox[{"RQSOrd", "[", 
            RowBox[{"[", "n", "]"}], "]"}], ",", 
           RowBox[{"RQSOrd", "[", 
            RowBox[{"[", 
             RowBox[{"n", "+", "1"}], "]"}], "]"}], ",", "LocTrackerPI"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"LocTrackerPI", "=", 
         RowBox[{"OutSlice", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "OutSlice"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"n", ",", "1", ",", 
         RowBox[{"2", "*", 
          RowBox[{"Quotient", "[", 
           RowBox[{"NQ", ",", "2"}], "]"}]}], ",", "2"}], "}"}]}], "]"}]}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.9034242205919013`*^9, 3.90342424310633*^9}, {
  3.9034409654257812`*^9, 3.903440968707676*^9}, {3.9034410173388443`*^9, 
  3.903441018645773*^9}, {3.9034415718568296`*^9, 3.90344158404119*^9}, {
  3.905316058237693*^9, 3.9053161058666687`*^9}, {3.9053163370295935`*^9, 
  3.9053163554302425`*^9}, {3.9053175825777516`*^9, 3.9053175827728148`*^9}, {
  3.905319831925749*^9, 3.905319848145866*^9}, {3.905319912788974*^9, 
  3.9053199231896043`*^9}, {3.9053244718067856`*^9, 3.905324490197588*^9}, {
  3.905324537862792*^9, 3.9053245381254206`*^9}},
 CellLabel->
  "In[595]:=",ExpressionUUID->"d0bd97a7-802b-4922-b5a6-236210d0ea0e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InitCirc", "[", 
   RowBox[{"Reg_", ",", "MaxNQ_"}], "]"}], ":=", 
  RowBox[{"Table", "[", 
   RowBox[{
    SubscriptBox["Init", "b"], ",", 
    RowBox[{"{", 
     RowBox[{"b", ",", "0", ",", 
      RowBox[{"MaxNQ", "-", "1"}], ",", "1"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.9036024393891897`*^9, 3.9036024446987076`*^9}, {
   3.903603833879928*^9, 3.9036038397873125`*^9}, {3.9036039583938475`*^9, 
   3.903603975218149*^9}, {3.9036050851952734`*^9, 3.9036050877676463`*^9}, {
   3.9036158815251513`*^9, 3.903615907098069*^9}, {3.903617069848643*^9, 
   3.9036170893337793`*^9}, {3.9036171534421606`*^9, 
   3.9036172638226814`*^9}, {3.903617297678636*^9, 3.903617424480298*^9}, {
   3.9049795518673873`*^9, 3.9049795817278023`*^9}, {3.905316139665906*^9, 
   3.9053161720540333`*^9}, {3.905316292895106*^9, 3.905316311999778*^9}, {
   3.9053168591222477`*^9, 3.9053168785736623`*^9}, {3.905319729517577*^9, 
   3.9053197404082303`*^9}, {3.905319930673061*^9, 3.905319945755684*^9}, {
   3.905323283022395*^9, 3.905323304506102*^9}, {3.9053245739744596`*^9, 
   3.9053245796477914`*^9}, {3.905324624955392*^9, 3.905324630236641*^9}, {
   3.9053250815168495`*^9, 3.905325092400052*^9}, 3.9053254390181837`*^9},
 CellLabel->
  "In[601]:=",ExpressionUUID->"8f5bd6d7-e061-4ee3-ac90-075487e82e1a"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Generate", " ", "circuit", " ", "of", " ", "m"}], "=", 
    RowBox[{"d", " ", "layers", " ", "of", " ", "SU", 
     RowBox[{"(", "4", ")"}], " ", "gates"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"QVCirc", "[", 
    RowBox[{"DataSet_", ",", "NQ_", ",", "ConnectivityRule_"}], "]"}], ":=", 
   RowBox[{"Which", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"StringContainsQ", "[", 
      RowBox[{"ConnectivityRule", ",", "\"\<ARPMove\>\""}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"RQS", "=", 
         RowBox[{"NRandQbits", "[", 
          RowBox[{"NQ", ",", "i"}], "]"}]}], ";", 
        RowBox[{"QVLayerARPMove", "[", 
         RowBox[{"DataSet", ",", "NQ", ",", "RQS", ",", "i"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", 
         RowBox[{"NQ", "-", "1"}], ",", "1"}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"StringContainsQ", "[", 
      RowBox[{"ConnectivityRule", ",", "\"\<PIMove\>\""}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"RQS", "=", 
         RowBox[{"NRandQbits", "[", 
          RowBox[{"NQ", ",", "i"}], "]"}]}], ";", 
        RowBox[{"QVLayerPIMove", "[", 
         RowBox[{"DataSet", ",", "NQ", ",", "RQS", ",", "i"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", 
         RowBox[{"NQ", "-", "1"}], ",", "1"}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"StringContainsQ", "[", 
      RowBox[{"ConnectivityRule", ",", "\"\<PIParMove\>\""}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"RQS", "=", 
           RowBox[{"NRandQbits", "[", 
            RowBox[{"NQ", ",", "i"}], "]"}]}], ";", 
          RowBox[{"QVLayerPIParMove", "[", 
           RowBox[{"DataSet", ",", "NQ", ",", "RQS", ",", "i"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", 
           RowBox[{"NQ", "-", "1"}], ",", "1"}], "}"}]}], "]"}], ",", "1"}], 
      "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"StringContainsQ", "[", 
      RowBox[{"ConnectivityRule", ",", "\"\<ARPParMove\>\""}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"RQS", "=", 
           RowBox[{"NRandQbits", "[", 
            RowBox[{"NQ", ",", "i"}], "]"}]}], ";", 
          RowBox[{"QVLayerARPParMove", "[", 
           RowBox[{"DataSet", ",", "NQ", ",", "RQS", ",", "i"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", 
           RowBox[{"NQ", "-", "1"}], ",", "1"}], "}"}]}], "]"}], ",", "1"}], 
      "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"StringContainsQ", "[", 
      RowBox[{"ConnectivityRule", ",", "\"\<PIPropSWAP\>\""}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"OutCirc", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"RQS", "=", 
            RowBox[{"NRandQbits", "[", 
             RowBox[{"NQ", ",", "i"}], "]"}]}], ";", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"i", "==", "0"}], ",", " ", 
             RowBox[{"LocTrac", "=", 
              RowBox[{"Range", "[", 
               RowBox[{"0", ",", 
                RowBox[{"NQ", "-", "1"}]}], "]"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"LocNCirc", "=", 
            RowBox[{"QVLayerPIPropSWAP", "[", 
             RowBox[{
             "DataSet", ",", "NQ", ",", "RQS", ",", "i", ",", "LocTrac"}], 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"LocTrac", "=", 
            RowBox[{"LocNCirc", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"LocNCirc", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "0", ",", 
            RowBox[{"NQ", "-", "1"}], ",", "1"}], "}"}]}], "]"}], "]"}]}], 
      ";", 
      RowBox[{"{", "OutCirc", "}"}]}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"StringContainsQ", "[", 
      RowBox[{"ConnectivityRule", ",", "\"\<ARPPropSWAP\>\""}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"OutCirc", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"RQS", "=", 
            RowBox[{"NRandQbits", "[", 
             RowBox[{"NQ", ",", "i"}], "]"}]}], ";", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"i", "==", "0"}], ",", " ", 
             RowBox[{"LocTrac", "=", 
              RowBox[{"Range", "[", 
               RowBox[{"0", ",", 
                RowBox[{"NQ", "-", "1"}]}], "]"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"LocNCirc", "=", 
            RowBox[{"QVLayerARPPropSWAP", "[", 
             RowBox[{
             "DataSet", ",", "NQ", ",", "RQS", ",", "i", ",", "LocTrac"}], 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"LocTrac", "=", 
            RowBox[{"LocNCirc", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"LocNCirc", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "0", ",", 
            RowBox[{"NQ", "-", "1"}], ",", "1"}], "}"}]}], "]"}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", "OutCirc", "}"}]}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.9036024393891897`*^9, 3.9036024446987076`*^9}, {
   3.903603833879928*^9, 3.9036038397873125`*^9}, {3.9036039583938475`*^9, 
   3.903603975218149*^9}, {3.9036050851952734`*^9, 3.9036050877676463`*^9}, {
   3.9036158815251513`*^9, 3.903615907098069*^9}, {3.903617069848643*^9, 
   3.9036170893337793`*^9}, {3.9036171534421606`*^9, 
   3.9036172638226814`*^9}, {3.903617297678636*^9, 3.903617424480298*^9}, {
   3.9049795518673873`*^9, 3.9049795817278023`*^9}, {3.905316139665906*^9, 
   3.9053161720540333`*^9}, {3.905316292895106*^9, 3.905316311999778*^9}, {
   3.9053168591222477`*^9, 3.9053168785736623`*^9}, {3.905319729517577*^9, 
   3.9053197404082303`*^9}, {3.905319930673061*^9, 3.905319945755684*^9}, {
   3.905323283022395*^9, 3.905323304506102*^9}, {3.9053245739744596`*^9, 
   3.9053245796477914`*^9}, {3.905324624955392*^9, 3.905324630236641*^9}, {
   3.9053250815168495`*^9, 3.905325092400052*^9}, 3.9053254390181837`*^9, {
   3.9053259824253864`*^9, 3.905326024817163*^9}, {3.9053260666081133`*^9, 
   3.905326086969303*^9}, {3.90532612854474*^9, 3.9053261604790974`*^9}, {
   3.9053263302734513`*^9, 3.905326365049464*^9}, {3.9053311442927065`*^9, 
   3.905331192524987*^9}, {3.9053316095608807`*^9, 3.9053316149880795`*^9}, {
   3.9053318949439583`*^9, 3.9053319364473886`*^9}, {3.90533312806379*^9, 
   3.905333131893487*^9}, {3.9053332896224995`*^9, 3.905333290016983*^9}, {
   3.9053335652658978`*^9, 3.9053335815678473`*^9}, 3.905334057396166*^9},
 CellLabel->
  "In[602]:=",ExpressionUUID->"a3d6ca76-f896-4cb9-a40b-833b8a467bde"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Generating", " ", "and", " ", "applying", " ", "the", " ", "circuits", 
    " ", "to", " ", "a", " ", "register", " ", "and", " ", "getting", " ", 
    "the", " ", "probability", " ", "of", " ", "a", " ", "heavy", " ", 
    "output"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Perfect", " ", "renormalisation", " ", "on", " ", "a", " ", "given", " ",
      "circuit"}], ",", " ", 
    RowBox[{
    "unsure", " ", "if", " ", "this", " ", "is", " ", "best", " ", "or", " ", 
     "if", " ", "taking", " ", "an", " ", "average", " ", "across", " ", 
     "the", " ", "NCirc", " ", "is", " ", "a", " ", "more", " ", 
     "\"\<accurate\>\"", " ", "scheme"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"QVProcedure", "[", 
     RowBox[{
     "DataSet_", ",", "NQ_", ",", " ", "MaxNQ_", ",", "NReps_", ",", "Reg_", 
      ",", "ConnectivityRule_"}], "]"}], ":=", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Circ1", "=", 
        RowBox[{"QVCirc", "[", 
         RowBox[{
          RowBox[{"DataSet", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{
              RowBox[{"NQ", "*", 
               RowBox[{"Quotient", "[", 
                RowBox[{"NQ", ",", "2"}], "]"}], "*", "Rep"}], "+", "1"}], ";;", 
             RowBox[{"NQ", "*", 
              RowBox[{"Quotient", "[", 
               RowBox[{"NQ", ",", "2"}], "]"}], "*", 
              RowBox[{"(", 
               RowBox[{"Rep", "+", "1"}], ")"}]}]}], "]"}], "]"}], ",", "NQ", 
          ",", "ConnectivityRule"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Initialisation", "=", 
        RowBox[{"{", 
         RowBox[{"InitCirc", "[", 
          RowBox[{"Reg", ",", "MaxNQ"}], "]"}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"InitCircuit", "=", 
        RowBox[{"Join", "[", 
         RowBox[{"Initialisation", ",", "Circ1"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"StringContainsQ", "[", 
          RowBox[{"ConnectivityRule", ",", "\"\<SWAP\>\""}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Options", "[", "RydbergHub", "]"}], "=", "SWAPConfig"}], 
          ";", 
          RowBox[{"RydDev", "=", 
           RowBox[{"RydbergHub", "[", "]"}]}], ";", 
          RowBox[{"InitCircuit", "=", 
           RowBox[{"CircRydbergHub", "[", 
            RowBox[{
             RowBox[{"Flatten", "[", "InitCircuit", "]"}], ",", "RydDev", ",", 
             RowBox[{"Parallel", "->", "True"}]}], "]"}]}]}], ",", 
         RowBox[{"StringContainsQ", "[", 
          RowBox[{"ConnectivityRule", ",", "\"\<Par\>\""}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Options", "[", "RydbergHub", "]"}], "=", 
           "ParallelConfig"}], ";", 
          RowBox[{"RydDev", "=", 
           RowBox[{"RydbergHub", "[", "]"}]}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", "Circ1", "]"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"CircNoisy", "=", 
        RowBox[{"ExtractCircuit", "[", 
         RowBox[{"InsertCircuitNoise", "[", 
          RowBox[{"InitCircuit", ",", "RydDev", ",", 
           RowBox[{"ReplaceAliases", "->", "True"}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"StringContainsQ", "[", 
          RowBox[{"ConnectivityRule", ",", "\"\<SWAP\>\""}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Options", "[", "RydbergHub", "]"}], "=", "SWAPConfig"}], 
          ";", 
          RowBox[{"RydDev", "=", 
           RowBox[{"RydbergHub", "[", "]"}]}]}], ",", 
         RowBox[{"StringContainsQ", "[", 
          RowBox[{"ConnectivityRule", ",", "\"\<Par\>\""}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Options", "[", "RydbergHub", "]"}], "=", 
           "ParallelConfig"}], ";", 
          RowBox[{"RydDev", "=", 
           RowBox[{"RydbergHub", "[", "]"}]}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"CircModel", "=", 
        RowBox[{"ExtractCircuit", "[", 
         RowBox[{"GetCircuitSchedule", "[", 
          RowBox[{"Circ1", ",", "RydDev", ",", 
           RowBox[{"ReplaceAliases", "->", "True"}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", "CircModel", "]"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"SetQuregMatrix", "[", 
        RowBox[{"Reg", ",", "RandState"}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"StringContainsQ", "[", 
          RowBox[{"ConnectivityRule", ",", "\"\<SWAP\>\""}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Options", "[", "RydbergHub", "]"}], "=", "SWAPConfig"}], 
          ";", 
          RowBox[{"RydDev", "=", 
           RowBox[{"RydbergHub", "[", "]"}]}]}], ",", 
         RowBox[{"StringContainsQ", "[", 
          RowBox[{"ConnectivityRule", ",", "\"\<Par\>\""}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Options", "[", "RydbergHub", "]"}], "=", 
           "ParallelConfig"}], ";", 
          RowBox[{"RydDev", "=", 
           RowBox[{"RydbergHub", "[", "]"}]}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ApplyCircuit", "[", 
        RowBox[{"Reg", ",", "CircNoisy"}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"PoutcomesNoisy", "=", 
        RowBox[{"CalcProbOfAllOutcomes", "[", 
         RowBox[{"Reg", ",", 
          RowBox[{"Range", "[", 
           RowBox[{"0", ",", 
            RowBox[{"NQ", "-", "1"}]}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", "PoutcomesNoisy", "]"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"InitZeroState", "[", "Reg", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"DrawCircuit", "[", "CircModel", "]"}], "]"}], ";"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"StringContainsQ", "[", 
          RowBox[{"ConnectivityRule", ",", "\"\<SWAP\>\""}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Options", "[", "RydbergHub", "]"}], "=", "SWAPConfig"}], 
          ";", 
          RowBox[{"RydDev", "=", 
           RowBox[{"RydbergHub", "[", "]"}]}]}], ",", 
         RowBox[{"StringContainsQ", "[", 
          RowBox[{"ConnectivityRule", ",", "\"\<Par\>\""}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Options", "[", "RydbergHub", "]"}], "=", 
           "ParallelConfig"}], ";", 
          RowBox[{"RydDev", "=", 
           RowBox[{"RydbergHub", "[", "]"}]}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ApplyCircuit", "[", 
        RowBox[{"Reg", ",", "CircModel"}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"PoutcomesModel", "=", 
        RowBox[{"CalcProbOfAllOutcomes", "[", 
         RowBox[{"Reg", ",", 
          RowBox[{"Range", "[", 
           RowBox[{"0", ",", 
            RowBox[{"NQ", "-", "1"}]}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"PNoLoss", "=", 
        RowBox[{"Total", "[", "PoutcomesNoisy", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"PoutcomesNoisyRen", "=", 
        RowBox[{"PoutcomesNoisy", "/", "PNoLoss"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
          "NQ", ",", " ", "\"\< Model Outcomes Probabilities \>\"", ",", 
           "PoutcomesModel", ",", "\"\< Noisy Outcome Probabilities \>\"", 
           ",", "PoutcomesNoisy"}], "]"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"HeavyOutputs", "=", 
        RowBox[{"CheckHeavyOutputProb", "[", 
         RowBox[{"PoutcomesNoisy", ",", "PoutcomesModel"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"HeavyOutputsRen", "=", 
        RowBox[{"CheckHeavyOutputProb", "[", 
         RowBox[{"PoutcomesNoisyRen", ",", "PoutcomesModel"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Total", "[", "HeavyOutputs", "]"}], ",", 
         RowBox[{"Total", "[", "HeavyOutputsRen", "]"}], ",", 
         RowBox[{"1", "-", "PNoLoss"}]}], "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"Rep", ",", "0", ",", 
        RowBox[{"NReps", "-", "1"}], ",", "1"}], "}"}]}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.9036152371461215`*^9, 3.903615262921678*^9}, {
   3.9036156178451767`*^9, 3.903615621905425*^9}, {3.903615775181942*^9, 
   3.9036158221391172`*^9}, {3.9049747134887824`*^9, 3.904974714540086*^9}, {
   3.9049763478275194`*^9, 3.9049763622853503`*^9}, {3.904976408187929*^9, 
   3.9049764164060497`*^9}, {3.9049764468687*^9, 3.9049764534810534`*^9}, {
   3.9049802167189245`*^9, 3.9049802390992875`*^9}, {3.9049818749574537`*^9, 
   3.9049819337741647`*^9}, {3.9049826168586864`*^9, 3.9049826176910124`*^9}, 
   3.905316264503873*^9, {3.905316977002417*^9, 3.9053169939636736`*^9}, {
   3.9053170796343794`*^9, 3.9053170816592536`*^9}, {3.905317191141176*^9, 
   3.905317202573551*^9}, {3.9053176310820665`*^9, 3.90531763628022*^9}, {
   3.9053246533301077`*^9, 3.905324726555809*^9}, {3.9053248417206755`*^9, 
   3.9053248420637283`*^9}, {3.9053251266359115`*^9, 
   3.9053251368953342`*^9}, {3.905325257413123*^9, 3.9053252645604224`*^9}, {
   3.905325702891265*^9, 3.9053257072556667`*^9}, {3.9053261738599925`*^9, 
   3.905326181300861*^9}, {3.9053262319971447`*^9, 3.9053262352797327`*^9}, {
   3.9053299519295626`*^9, 3.905330019917454*^9}, {3.9053300777914157`*^9, 
   3.9053301291308217`*^9}, {3.905330438830475*^9, 3.905330448334558*^9}, {
   3.9053306079049816`*^9, 3.905330621946402*^9}, {3.9053308530647526`*^9, 
   3.9053308819711637`*^9}, {3.9053316803656855`*^9, 
   3.9053317404914484`*^9}, {3.905332889869175*^9, 3.905332910947068*^9}, {
   3.9053329760673885`*^9, 3.90533300646647*^9}, {3.9053331136753144`*^9, 
   3.9053331223854866`*^9}, {3.9053332155495176`*^9, 3.905333239149444*^9}, {
   3.905333477114665*^9, 3.90533349322528*^9}, {3.9053337093392315`*^9, 
   3.905333709625255*^9}, {3.905335081805642*^9, 3.905335087408367*^9}, {
   3.9053356198390846`*^9, 3.905335639508606*^9}, {3.9053357418820534`*^9, 
   3.905335762446327*^9}, {3.905336099550426*^9, 3.905336108750354*^9}, {
   3.9055091532206707`*^9, 3.905509180240279*^9}, {3.9055092377389374`*^9, 
   3.9055092396402454`*^9}, {3.9055696676923156`*^9, 
   3.9055696702059584`*^9}, {3.9055703110121098`*^9, 3.905570383666526*^9}},
 CellLabel->
  "In[633]:=",ExpressionUUID->"12f1ca1b-be95-44a2-b5ab-ff7b7b163c8a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Put", " ", "everything", " ", "together", " ", "and", " ", "get", " ", 
    "a", " ", "value", " ", "for", " ", "Quantum", " ", "Volume"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"QVCalc", "[", 
     RowBox[{
     "DataSet_", ",", "MaxNQ_", ",", "NReps_", ",", "ConnectivityRule_"}], 
     "]"}], ":=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Rho]", "=", 
        RowBox[{"CreateDensityQureg", "[", "MaxNQ", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"DataStart", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Total", "[", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"a", "*", 
                 RowBox[{"Quotient", "[", 
                  RowBox[{"a", ",", "2"}], "]"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"a", ",", "0", ",", 
                  RowBox[{"NQ", "-", "1"}]}], "}"}]}], "]"}], "]"}], "*", 
             "NReps"}], ")"}], "+", "1"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"DataEnd", "=", 
          RowBox[{"Total", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"a", "*", 
               RowBox[{"Quotient", "[", 
                RowBox[{"a", ",", "2"}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"a", ",", "0", ",", "NQ"}], "}"}]}], "]"}], "*", 
            "NReps"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{
          "NQ", ",", "\"\<  \>\"", ",", "DataStart", ",", "\"\<  \>\"", ",", 
           "DataEnd"}], "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"HOP", "=", 
        RowBox[{"QVProcedure", "[", 
         RowBox[{
          RowBox[{"DSSplice", "=", 
           RowBox[{"DataSet", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Total", "[", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"a", "*", 
                    RowBox[{"Quotient", "[", 
                    RowBox[{"a", ",", "2"}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"a", ",", "0", ",", 
                    RowBox[{"NQ", "-", "1"}]}], "}"}]}], "]"}], "]"}], "*", 
                 "NReps"}], ")"}], "+", "1"}], " ", ";;", 
              RowBox[{"Total", "[", 
               RowBox[{
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"a", "*", 
                   RowBox[{"Quotient", "[", 
                    RowBox[{"a", ",", "2"}], "]"}]}], ",", 
                  RowBox[{"{", 
                   RowBox[{"a", ",", "0", ",", "NQ"}], "}"}]}], "]"}], "*", 
                "NReps"}], "]"}]}], "]"}], "]"}]}], ",", "NQ", ",", "MaxNQ", 
          ",", "NReps", ",", "\[Rho]", ",", "ConnectivityRule"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"DestroyAllQuregs", "[", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"MHOP", "=", 
        RowBox[{"Mean", "[", 
         RowBox[{"HOP", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"MHOPRen", "=", 
        RowBox[{"Mean", "[", 
         RowBox[{"HOP", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"MPLoss", "=", 
        RowBox[{"Mean", "[", 
         RowBox[{"HOP", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "3"}], "]"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Sigma]PLoss", "=", 
        RowBox[{
         RowBox[{"StandardDeviation", "[", 
          RowBox[{"HOP", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "3"}], "]"}], "]"}], "]"}], "/", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"NReps", "-", "1"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[Sigma]", "=", 
        RowBox[{
         RowBox[{"StandardDeviation", "[", 
          RowBox[{"HOP", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}], "/", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"NReps", "-", "1"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[Sigma]Ren", "=", 
        RowBox[{
         RowBox[{"StandardDeviation", "[", 
          RowBox[{"HOP", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}], "/", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"NReps", "-", "1"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"Re", "[", 
           RowBox[{"(", 
            RowBox[{"MHOP", "-", 
             RowBox[{"2", "\[Sigma]"}]}], ")"}], "]"}], ">", 
          FractionBox["2", "3"]}], ",", 
         RowBox[{"VQ", "=", 
          SuperscriptBox["2", "NQ"]}], ",", 
         RowBox[{"VQ", "=", "0"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"Re", "[", 
           RowBox[{"(", 
            RowBox[{"MHOPRen", "-", 
             RowBox[{"2", "\[Sigma]Ren"}]}], ")"}], "]"}], ">", 
          FractionBox["2", "3"]}], ",", 
         RowBox[{"VQRen", "=", 
          SuperscriptBox["2", "NQ"]}], ",", 
         RowBox[{"VQRen", "=", "0"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"{", 
         RowBox[{"\"\<Layer\>\"", ",", "NQ", ",", "VQ", ",", "VQRen"}], "}"}],
         "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"NQ", ",", "MHOP", ",", 
           RowBox[{"2", "\[Sigma]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"NQ", ",", "MHOPRen", ",", 
           RowBox[{"2", "\[Sigma]Ren"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"NQ", ",", "MPLoss", ",", "\[Sigma]PLoss"}], "}"}]}], 
        "}"}]}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"NQ", ",", "2", ",", "MaxNQ", ",", "1"}], "}"}]}], "]"}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.9036152371461215`*^9, 3.903615262921678*^9}, {
   3.9036156178451767`*^9, 3.903615621905425*^9}, {3.903615775181942*^9, 
   3.9036158221391172`*^9}, {3.9049747134887824`*^9, 3.904974714540086*^9}, {
   3.9049763478275194`*^9, 3.9049763622853503`*^9}, {3.904976408187929*^9, 
   3.9049764164060497`*^9}, {3.9049764468687*^9, 3.9049764534810534`*^9}, {
   3.9049802167189245`*^9, 3.9049802390992875`*^9}, {3.9049818749574537`*^9, 
   3.9049819337741647`*^9}, {3.9049826168586864`*^9, 3.9049826176910124`*^9}, 
   3.905316264503873*^9, {3.9055089242212296`*^9, 3.9055090483157363`*^9}, 
   3.9055091624065523`*^9, 3.9055093854706283`*^9, {3.9055694551622505`*^9, 
   3.905569455303532*^9}, {3.9055713349456882`*^9, 
   3.9055713379907055`*^9}},ExpressionUUID->"a863265f-b3ef-485c-854e-\
57df0f3c1f64"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "RydbergHub", "]"}], "=", "ParallelConfig"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RydDev", "=", 
   RowBox[{"RydbergHub", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"QVCalc", "[", 
   RowBox[{"data", ",", "9", ",", "20", ",", "\"\<PIParMove\>\""}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"Options", "[", "RydbergHub", "]"}], "=", "SWAPConfig"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"RydDev", "=", 
     RowBox[{"RydbergHub", "[", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"QVCalc", "[", 
     RowBox[{"data", ",", "9", ",", "20", ",", "\"\<PIPropSWAP\>\""}], 
     "]"}]}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.9049741863291483`*^9, 3.904974235871242*^9}, {
   3.904979853836957*^9, 3.9049798546331215`*^9}, {3.9049803643176966`*^9, 
   3.9049803658869467`*^9}, {3.904982354788396*^9, 3.904982355820116*^9}, {
   3.904983262548837*^9, 3.904983264005209*^9}, {3.905317838187149*^9, 
   3.90531787044862*^9}, {3.905318585432578*^9, 3.905318586754868*^9}, {
   3.905319754227268*^9, 3.9053197552604227`*^9}, {3.9053244015370893`*^9, 
   3.9053244334008403`*^9}, {3.9053256537914696`*^9, 
   3.9053256886130424`*^9}, {3.905325871023*^9, 3.9053258780400996`*^9}, {
   3.905325936604883*^9, 3.9053259411045794`*^9}, {3.9053261948963385`*^9, 
   3.9053261997634845`*^9}, {3.9053262657584076`*^9, 
   3.9053262698377404`*^9}, {3.9053306756265283`*^9, 
   3.9053306857251453`*^9}, {3.9053307372516465`*^9, 
   3.9053307912836485`*^9}, {3.9053312060924277`*^9, 3.9053312062388644`*^9}, 
   3.9053314137992954`*^9, {3.905332847418937*^9, 3.9053328805220985`*^9}, {
   3.905333170171043*^9, 3.905333170804341*^9}, {3.905333399212797*^9, 
   3.905333403723368*^9}, {3.905333774965371*^9, 3.905333782005699*^9}, {
   3.905334069193355*^9, 3.905334071691842*^9}, 3.9053350980634017`*^9, 
   3.905335771711623*^9, {3.9053359135628633`*^9, 3.9053359136613646`*^9}, 
   3.9053362095732846`*^9, {3.9054815905989685`*^9, 3.905481598517989*^9}, {
   3.9055037094393454`*^9, 3.905503714113035*^9}, {3.90557062108428*^9, 
   3.905570625688933*^9}},
 CellLabel->
  "In[643]:=",ExpressionUUID->"627908bd-c7b1-4324-90be-beb20db519cd"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"Layer\"\>", ",", "2", ",", "4", ",", "4"}], "}"}]], "Print",
 CellChangeTimes->{
  3.905330791812439*^9, 3.905330890087246*^9, 3.905330959467353*^9, 
   3.905331206789929*^9, 3.90533141572003*^9, 3.9053316239738283`*^9, 
   3.9053317504704967`*^9, 3.9053319423031163`*^9, 3.9053328520532255`*^9, 
   3.905332917292514*^9, 3.905333017492258*^9, {3.905333139535468*^9, 
   3.9053331901233315`*^9}, 3.905333296527833*^9, 3.905333407379374*^9, 
   3.9053335006744075`*^9, 3.9053335914260693`*^9, 3.905333716683917*^9, 
   3.9053337844159174`*^9, 3.9053340893116174`*^9, 3.9053351155179596`*^9, {
   3.905335773663062*^9, 3.905335787934252*^9}, 3.9053359142777557`*^9, 
   3.905336115003371*^9, 3.9053362251592197`*^9, 3.905481751769086*^9, 
   3.905504625843329*^9, 3.905507615702505*^9, 3.905508215373044*^9, 
   3.905509012324218*^9, 3.905509052394286*^9, 3.9055092575551715`*^9, 
   3.9055093985027056`*^9, 3.905509528931243*^9, 3.905510313462827*^9, 
   3.9055103516612663`*^9, 3.9055104225798893`*^9, 3.905510479314474*^9, 
   3.9055694729013653`*^9, 3.9055695165615015`*^9, 3.90556955791991*^9, 
   3.9055704053332806`*^9, 3.905570449328449*^9, 3.9055706391961823`*^9, 
   3.90557083124751*^9},
 CellLabel->
  "During evaluation of \
In[643]:=",ExpressionUUID->"407667ce-42ed-4919-9e0b-74e0d5008d68"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"Layer\"\>", ",", "3", ",", "8", ",", "8"}], "}"}]], "Print",
 CellChangeTimes->{
  3.905330791812439*^9, 3.905330890087246*^9, 3.905330959467353*^9, 
   3.905331206789929*^9, 3.90533141572003*^9, 3.9053316239738283`*^9, 
   3.9053317504704967`*^9, 3.9053319423031163`*^9, 3.9053328520532255`*^9, 
   3.905332917292514*^9, 3.905333017492258*^9, {3.905333139535468*^9, 
   3.9053331901233315`*^9}, 3.905333296527833*^9, 3.905333407379374*^9, 
   3.9053335006744075`*^9, 3.9053335914260693`*^9, 3.905333716683917*^9, 
   3.9053337844159174`*^9, 3.9053340893116174`*^9, 3.9053351155179596`*^9, {
   3.905335773663062*^9, 3.905335787934252*^9}, 3.9053359142777557`*^9, 
   3.905336115003371*^9, 3.9053362251592197`*^9, 3.905481751769086*^9, 
   3.905504625843329*^9, 3.905507615702505*^9, 3.905508215373044*^9, 
   3.905509012324218*^9, 3.905509052394286*^9, 3.9055092575551715`*^9, 
   3.9055093985027056`*^9, 3.905509528931243*^9, 3.905510313462827*^9, 
   3.9055103516612663`*^9, 3.9055104225798893`*^9, 3.905510479314474*^9, 
   3.9055694729013653`*^9, 3.9055695165615015`*^9, 3.90556955791991*^9, 
   3.9055704053332806`*^9, 3.905570449328449*^9, 3.9055706391961823`*^9, 
   3.905570846645384*^9},
 CellLabel->
  "During evaluation of \
In[643]:=",ExpressionUUID->"9d01cf59-f3db-4512-a9e3-af40395f71dc"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", "0.7476656887953339`", ",", "0.03751412426457144`"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "0.7724372218929967`", ",", "0.03865564829846596`"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "2", ",", "0.032094259597471884`", ",", "0.00018877395898943364`"}], 
      "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "3", ",", "0.965115864210403`", ",", "0.00028309029223705145`"}], "}"}],
      ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "1.`", ",", "5.4814816543375465`*^-17"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "3", ",", "0.03488413578959712`", ",", "0.00014154514611852573`"}], 
      "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.905570466105608*^9, 3.905570654576932*^9, 
  3.905570846653404*^9},
 CellLabel->
  "Out[645]=",ExpressionUUID->"f15479b3-5dc3-42bb-9067-0ec13c1d47c9"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"2", ",", "0.7476656887953339`", ",", "0.03751412426457144`"}],
        "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "0.7724372218929967`", ",", "0.03865564829846596`"}],
        "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "2", ",", "0.032094259597471884`", ",", "0.00018877395898943364`"}], 
       "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "3", ",", "0.9651158759876234`", ",", "0.00028318048102866667`"}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "1.`", ",", "3.5059674461847047`*^-17"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "3", ",", "0.03488412401237671`", ",", "0.00014159024051433333`"}], 
       "}"}]}], "}"}]}], "}"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.9055704300354185`*^9, 
  3.905570430390021*^9}},ExpressionUUID->"f1fd7ef4-5a31-4399-a7ac-\
e0b9dab38da1"],

Cell[BoxData[{
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", "0.747667329173313`", ",", "0.03751434121741379`"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "0.7724389160514784`", ",", "0.03865587154102743`"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "2", ",", "0.03209425915824953`", ",", "0.00018877445775183603`"}], 
      "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "3", ",", "0.9651158765723868`", ",", "0.00028318199434849533`"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "1.`", ",", "4.0483424976496074`*^-17"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "3", ",", "0.034884123427613`", ",", "0.00014159099717424767`"}], 
      "}"}]}], "}"}]}], "}"}], "\[IndentingNewLine]", 
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", "0.747667329173313`", ",", "0.03751434121741379`"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "0.7724389160514784`", ",", "0.03865587154102743`"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "2", ",", "0.03209425915824953`", ",", "0.00018877445775183603`"}], 
      "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "3", ",", "0.9651158765723868`", ",", "0.00028318199434849533`"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "1.`", ",", "4.0483424976496074`*^-17"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "3", ",", "0.034884123427613`", ",", "0.00014159099717424767`"}], 
      "}"}]}], "}"}]}], "}"}]}], "Input",
 CellChangeTimes->{{3.905569535615077*^9, 
  3.905569537098881*^9}},ExpressionUUID->"3594fef4-6189-4e3f-876a-\
02d78b3aca8d"],

Cell[BoxData[{
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", "0.7601513171947132`", ",", "0.04292873574593213`"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "0.7854097528197816`", ",", "0.04437782473865333`"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "2", ",", "0.0321529360439789`", ",", "0.0001167499254821025`"}], 
      "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"3", ",", "0.8060826520360566`", ",", "0.03540618706319306`"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "0.8365955270367473`", ",", "0.0366146036507514`"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "3", ",", "0.03649436497698759`", ",", "0.0004003731439281614`"}], 
      "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"4", ",", "0.8135445154178569`", ",", "0.016488361611556573`"}],
       "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "0.8576407317864303`", ",", "0.01696166627636412`"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "4", ",", "0.05145382567322872`", ",", "0.0004963811361840193`"}], 
      "}"}]}], "}"}]}], "}"}], "\[IndentingNewLine]", 
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", "0.7731385821533683`", ",", "0.04867268560575238`"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "0.7988718069158642`", ",", "0.05024247392876599`"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "2", ",", "0.03222664009468495`", ",", "0.00017049067156154203`"}], 
      "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"3", ",", "0.8126057680101855`", ",", "0.03862736910523318`"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "0.84354480244795`", ",", "0.04019628710730518`"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "3", ",", "0.03665204821479291`", ",", "0.00037663121804423197`"}], 
      "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"4", ",", "0.8060410157485876`", ",", "0.02245360387081677`"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "0.849580340752597`", ",", "0.02354996013705393`"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "4", ",", "0.05126269648172497`", ",", "0.0003843736233589588`"}], 
      "}"}]}], "}"}]}], "}"}]}], "Input",
 CellChangeTimes->{{3.905510523488686*^9, 
  3.9055105238442907`*^9}},ExpressionUUID->"d4bc52f4-b034-405b-9218-\
cdf45afd8b7b"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"2", ",", "0.7526261028310963`", ",", "0.0457236160846363`"}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "0.7776921591144627`", ",", "0.04724882943592328`"}],
        "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "2", ",", "0.0322273609491375`", ",", "0.00016255759151651166`"}], 
       "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"3", ",", "0.7810473807824574`", ",", "0.0343138458609789`"}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "0.8111185701262199`", ",", "0.03544862956795256`"}],
        "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "3", ",", "0.03710351342461647`", ",", "0.00048105200526076474`"}], 
       "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "4", ",", "0.8014585781571968`", ",", "0.023823178451983253`"}], "}"}],
       ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "0.8453969533206968`", ",", "0.02552913794795476`"}],
        "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "4", ",", "0.05191446211509275`", ",", "0.0006419590710226834`"}], 
       "}"}]}], "}"}]}], "}"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", "0.7831757139192268`", ",", "0.04142807646362018`"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "0.8090557511563483`", ",", "0.0427535733382364`"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "2", ",", "0.03200164363767028`", ",", "0.000151418963785697`"}], 
      "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"3", ",", "0.8370589735251611`", ",", "0.04247023657745169`"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "0.8687508168459841`", ",", "0.04384405959655093`"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "3", ",", "0.03654610210262256`", ",", "0.0003361539954891725`"}], 
      "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"4", ",", "0.815894707717925`", ",", "0.013018872739737638`"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "0.8595323674549438`", ",", "0.013500775842303105`"}],
       "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "4", ",", "0.05078293585727441`", ",", "0.0005332506214373425`"}], 
      "}"}]}], "}"}]}], "}"}]}], "Input",
 CellChangeTimes->{{3.9055095665832176`*^9, 3.9055095719635253`*^9}},
 CellLabel->
  "In[264]:=",ExpressionUUID->"1bed2382-97a7-42d3-9f50-23dbc15fe081"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", "0.7526261028310963`", ",", "0.0457236160846363`"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "0.7776921591144627`", ",", "0.04724882943592328`"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "2", ",", "0.0322273609491375`", ",", "0.00016255759151651166`"}], 
      "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"3", ",", "0.7810473807824574`", ",", "0.0343138458609789`"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "0.8111185701262199`", ",", "0.03544862956795256`"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "3", ",", "0.03710351342461647`", ",", "0.00048105200526076474`"}], 
      "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"4", ",", "0.8014585781571968`", ",", "0.023823178451983253`"}],
       "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "0.8453969533206968`", ",", "0.02552913794795476`"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "4", ",", "0.05191446211509275`", ",", "0.0006419590710226834`"}], 
      "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.905509592975574*^9},
 CellLabel->
  "Out[264]=",ExpressionUUID->"bff94974-4590-4e96-ad5b-266ae5eb6e4e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", "0.7831757139192268`", ",", "0.04142807646362018`"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "0.8090557511563483`", ",", "0.0427535733382364`"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "2", ",", "0.03200164363767028`", ",", "0.000151418963785697`"}], 
      "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"3", ",", "0.8370589735251611`", ",", "0.04247023657745169`"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "0.8687508168459841`", ",", "0.04384405959655093`"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "3", ",", "0.03654610210262256`", ",", "0.0003361539954891725`"}], 
      "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"4", ",", "0.815894707717925`", ",", "0.013018872739737638`"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "0.8595323674549438`", ",", "0.013500775842303105`"}],
       "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "4", ",", "0.05078293585727441`", ",", "0.0005332506214373425`"}], 
      "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.9055095929852295`*^9},
 CellLabel->
  "Out[265]=",ExpressionUUID->"32a5112f-8d83-4d81-8686-10823d625fa6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RandState", "=", 
  RowBox[{"RandomMixState", "[", "9", "]"}]}]], "Input",
 CellChangeTimes->{{3.9055092045640907`*^9, 3.9055092152290792`*^9}},
 CellLabel->
  "In[605]:=",ExpressionUUID->"c188c145-d73d-4875-83da-231edfd9969d"],

Cell[BoxData[
 InterpretationBox[
  TagBox[
   FrameBox[GridBox[{
      {
       ItemBox[
        TagBox[
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0.002004604227024629`", ",", 
             RowBox[{
              RowBox[{"-", "0.0001447070872797587`"}], "+", 
              RowBox[{"8.810756621527088`*^-6", " ", "\[ImaginaryI]"}]}], ",", 
             RowBox[{"7.946511364048113`*^-6", "-", 
              RowBox[{"2.2167478810581114`*^-6", " ", "\[ImaginaryI]"}]}], 
             ",", 
             TemplateBox[{"506"},
              "OutputSizeLimit`Skeleton"], ",", 
             RowBox[{
              RowBox[{"-", "0.00003275343392548905`"}], "-", 
              RowBox[{"4.82163812485293`*^-6", " ", "\[ImaginaryI]"}]}], ",", 
             RowBox[{"7.033687410348155`*^-6", "+", 
              RowBox[{"0.0000242915006730229`", " ", "\[ImaginaryI]"}]}], ",", 
             RowBox[{"2.563058009878241`*^-6", "-", 
              RowBox[{"0.00005502632170434906`", " ", "\[ImaginaryI]"}]}]}], 
            "}"}], ",", 
           TemplateBox[{"510"},
            "OutputSizeLimit`Skeleton"], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"2.563058009878227`*^-6", "+", 
              TemplateBox[{"1"},
               "OutputSizeLimit`Skeleton"]}], ",", 
             TemplateBox[{"510"},
              "OutputSizeLimit`Skeleton"], ",", 
             TemplateBox[{"22"},
              "OutputSizeLimit`Skeleton"]}], "}"}]}], "}"}],
         Short[#, 5]& ],
        BaseStyle->{Deployed -> False},
        StripOnInput->False]},
      {GridBox[{
         {
          PaneBox[
           TagBox[
            TooltipBox[
             StyleBox[
              StyleBox[
               DynamicBox[ToBoxes[
                 FEPrivate`FrontEndResource[
                 "FEStrings", "sizeBriefExplanation"], StandardForm],
                ImageSizeCache->{63.972949218749996`, {3., 9.}}],
               StripOnInput->False,
               DynamicUpdating->True,
               LineSpacing->{1, 2},
               LineIndent->0,
               LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLText",
              StripOnInput->False],
             StyleBox[
              DynamicBox[
               ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"], 
                StandardForm]], DynamicUpdating -> True, LineIndent -> 0, 
              LinebreakAdjustments -> {1., 100, 0, 0, 0}, 
              LineSpacing -> {1, 2}, StripOnInput -> False]],
            Annotation[#, 
             Style[
              Dynamic[
               FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"]], 
              DynamicUpdating -> True, LineIndent -> 0, 
              LinebreakAdjustments -> {1., 100, 0, 0, 0}, 
              LineSpacing -> {1, 2}], "Tooltip"]& ],
           Alignment->Center,
           BaselinePosition->Baseline,
           ImageSize->{Automatic, {25, Full}}], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
                StandardForm],
               ImageSizeCache->{51.85019531249999, {0., 9.}}],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, {25, Full}}],
           Appearance->None,
           BaselinePosition->Baseline,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            OutputSizeLimit`Defer, 605, 21860084295581428627, 5/2],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
                StandardForm],
               ImageSizeCache->{60.756591796875, {0., 9.}}],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, {25, Full}}],
           Appearance->None,
           BaselinePosition->Baseline,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            OutputSizeLimit`Defer, 605, 21860084295581428627, 5 2],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
                StandardForm],
               ImageSizeCache->{44.84619140625, {0., 9.}}],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, {25, Full}}],
           Appearance->None,
           BaselinePosition->Baseline,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            OutputSizeLimit`Defer, 605, 21860084295581428627, Infinity],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
                StandardForm],
               ImageSizeCache->{77.649609375, {0., 9.}}],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, {25, Full}}],
           Appearance->None,
           BaselinePosition->Baseline,
           ButtonFunction:>FrontEndExecute[{
              FrontEnd`SetOptions[
              FrontEnd`$FrontEnd, 
               FrontEnd`PreferencesSettings -> {"Page" -> "Advanced"}], 
              FrontEnd`FrontEndToken["PreferencesDialog"]}],
           Evaluator->None,
           Method->"Preemptive"]}
        },
        AutoDelete->False,
        FrameStyle->GrayLevel[0.85],
        GridBoxDividers->{"Columns" -> {False, {True}}},
        GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
        GridBoxSpacings->{"Columns" -> {{2}}}]}
     },
     DefaultBaseStyle->"Column",
     GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
     GridBoxDividers->{"Columns" -> {{False}}, "Rows" -> {{False}}},
     GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], 
         Offset[1.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    BaseStyle->"OutputSizeLimit",
    FrameMargins->{{12, 12}, {0, 15}},
    FrameStyle->GrayLevel[0.85],
    RoundingRadius->5,
    StripOnInput->False],
   Deploy,
   DefaultBaseStyle->"Deploy"],
  If[21860084295581428627 === $SessionID, 
   Out[605], Message[
     MessageName[Syntax, "noinfoker"]]; Missing["NotAvailable"]; 
   Null]]], "Output",
 CellChangeTimes->{{3.905509202141057*^9, 3.9055092210979953`*^9}, 
   3.9055103464238315`*^9, 3.905510406831686*^9},
 CellLabel->
  "Out[605]=",ExpressionUUID->"61a9a801-f31c-4498-acad-1e2149c837f9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CalcCircuitMatrix", "[", 
  RowBox[{"ExtractCircuit", "[", 
   RowBox[{"GetCircuitSchedule", "[", 
    RowBox[{
     RowBox[{"{", 
      SubscriptBox["CZPIPar", 
       RowBox[{"0", ",", "1"}]], "}"}], ",", "RydDev", ",", 
     RowBox[{"ReplaceAliases", "->", "True"}]}], "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.904979663641651*^9, 3.9049797232573338`*^9}},
 CellLabel->
  "(Debug) In[883]:=",ExpressionUUID->"33e1a8fa-925e-40a6-ac33-6e2cdf8c62e0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", 
     RowBox[{"-", "1"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.9049795411430984`*^9, 3.904979657971982*^9, {3.904979713349429*^9, 
   3.9049797239658794`*^9}, 3.9049826650870495`*^9, 3.905330779850774*^9},
 CellLabel->
  "(Debug) Out[883]=",ExpressionUUID->"fd7d670d-a27b-452d-9648-65b38fc8e290"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{"ParallelLayer", "=", 
  RowBox[{"QVLayerPIParMove", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"data", "[", 
       RowBox[{"[", "200", "]"}], "]"}], ",", 
      RowBox[{"data", "[", 
       RowBox[{"[", "1000", "]"}], "]"}]}], "}"}], ",", "5", ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1", ",", "2", ",", "3", ",", "4"}], "}"}], ",", "0"}],
    "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TestRho", "=", 
   RowBox[{"CreateDensityQureg", "[", "9", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"InitZeroState", "[", "TestRho", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"NoisyCirc", "=", 
  RowBox[{"InsertCircuitNoise", "[", 
   RowBox[{"ParallelLayer", ",", "RydDev", ",", 
    RowBox[{"ReplaceAliases", "->", "True"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"ParCircSched", "=", 
  RowBox[{"GetCircuitSchedule", "[", 
   RowBox[{"ParallelLayer", ",", "RydDev", ",", 
    RowBox[{"ReplaceAliases", "->", "True"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"DrawCircuit", "[", "%", "]"}], "\[IndentingNewLine]", 
 RowBox[{"ApplyCircuit", "[", 
  RowBox[{"TestRho", ",", 
   RowBox[{"ExtractCircuit", "[", "ParCircSched", "]"}]}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.9034242846362906`*^9, 3.9034243021209717`*^9}, {
   3.9034243682685337`*^9, 3.9034244348637543`*^9}, {3.903439703429279*^9, 
   3.903439710055106*^9}, {3.9034401063798003`*^9, 3.9034401120089016`*^9}, {
   3.903440281022086*^9, 3.9034402897986174`*^9}, {3.9034406383222065`*^9, 
   3.903440641905593*^9}, {3.9034416951679015`*^9, 3.9034417115545144`*^9}, {
   3.903442181080386*^9, 3.9034421981274605`*^9}, {3.903442232961551*^9, 
   3.903442241991907*^9}, {3.903442325580459*^9, 3.9034424507764273`*^9}, {
   3.9034433325226316`*^9, 3.9034433755748854`*^9}, {3.9034434192413588`*^9, 
   3.90344346768495*^9}, {3.9034435095742264`*^9, 3.903443665091352*^9}, {
   3.9034438046905236`*^9, 3.903443893292336*^9}, {3.903443927958187*^9, 
   3.903443943264862*^9}, {3.903443989476727*^9, 3.903444081321884*^9}, {
   3.903444214896837*^9, 3.9034443717619905`*^9}, {3.903444429087962*^9, 
   3.9034444522834005`*^9}, {3.903444516122985*^9, 3.903444555718686*^9}, {
   3.9034446340310683`*^9, 3.903444663582247*^9}, {3.903445080843034*^9, 
   3.903445122263195*^9}, {3.9034451641459856`*^9, 3.903445247334509*^9}, {
   3.9034452800870104`*^9, 3.9034453454653854`*^9}, {3.9034454258372164`*^9, 
   3.9034454493374386`*^9}, {3.903445479815341*^9, 3.9034455537897053`*^9}, {
   3.90344566255406*^9, 3.903445683974117*^9}, {3.903445715428181*^9, 
   3.903445750512638*^9}, {3.9034459362764444`*^9, 3.903445953586826*^9}, {
   3.903445989929237*^9, 3.9034460021797676`*^9}, {3.9034461040227766`*^9, 
   3.9034461096291347`*^9}, {3.9034463437172375`*^9, 
   3.9034463850282254`*^9}, {3.9034470050037355`*^9, 
   3.9034470160389028`*^9}, {3.903447049469549*^9, 3.9034471906332273`*^9}, {
   3.903447242886093*^9, 3.9034472432787523`*^9}, {3.9034473067441835`*^9, 
   3.903447331990593*^9}, {3.9034473988023963`*^9, 3.9034474600078664`*^9}, {
   3.90344751891194*^9, 3.903447520833371*^9}, {3.903447611654488*^9, 
   3.903447613964037*^9}, {3.9034477900185947`*^9, 3.903447804276531*^9}, {
   3.903447846241626*^9, 3.9034478471866465`*^9}, {3.9034495554099817`*^9, 
   3.903449572817965*^9}, {3.9035017323510885`*^9, 3.9035017329425807`*^9}, {
   3.903502133677329*^9, 3.9035021437555075`*^9}, {3.9035035256413918`*^9, 
   3.9035036480817223`*^9}, {3.9035039878752747`*^9, 3.9035040492153234`*^9}, 
   3.903504137268469*^9, {3.9035928952629967`*^9, 3.9035929454847264`*^9}, {
   3.903592987524225*^9, 3.903593108837535*^9}, {3.9035931707616854`*^9, 
   3.903593208982791*^9}, {3.903593301457305*^9, 3.9035933256885347`*^9}, {
   3.903593870377265*^9, 3.9035939812758875`*^9}, {3.903594049580821*^9, 
   3.903594067554844*^9}, {3.903595053619876*^9, 3.903595079896531*^9}, {
   3.903600981894334*^9, 3.903600997784979*^9}, {3.903601046213812*^9, 
   3.903601099273239*^9}, {3.903601408834978*^9, 3.903601426717827*^9}, {
   3.903602989295418*^9, 3.9036030484188538`*^9}, {3.903603119248971*^9, 
   3.9036031230232134`*^9}, {3.903603155129772*^9, 3.903603158474721*^9}, 
   3.903603207550898*^9, {3.9036032440632353`*^9, 3.9036032704338636`*^9}, {
   3.903603309229307*^9, 3.9036033366214733`*^9}, {3.903603473114338*^9, 
   3.9036034877422943`*^9}, {3.9036159202196674`*^9, 3.903615961336343*^9}, {
   3.9036162869410973`*^9, 3.903616290208296*^9}, 3.9036167934990993`*^9, 
   3.9036179516925917`*^9, {3.903618032368924*^9, 3.9036180352636566`*^9}, {
   3.903618332577476*^9, 3.9036183335542183`*^9}, {3.903618520008212*^9, 
   3.903618521622857*^9}},
 CellLabel->
  "In[425]:=",ExpressionUUID->"7a548349-74fa-4c9a-8079-eadf4b6f3eb8"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"QVPISWAP20R", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "2", ",", "0.7802923488565782`", ",", "0.039117258590993284`"}], "}"}],
       ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "0.8062342454067106`", ",", "0.04040572489109859`"}],
        "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "2", ",", "0.032180797935755096`", ",", "0.00014781570611050514`"}], 
       "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"3", ",", "0.8063519178706487`", ",", "0.03450246996254051`"}],
        "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "0.8368883931070682`", ",", "0.035614608967936`"}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "3", ",", "0.036532472253468444`", ",", "0.0003150963706426632`"}], 
       "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "4", ",", "0.8194752658531623`", ",", "0.026205424681783333`"}], "}"}],
       ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "0.8638573034456`", ",", "0.027400280039652787`"}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "4", ",", "0.05141149271076615`", ",", "0.0005034843155500556`"}], 
       "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "5", ",", "0.8092420986028086`", ",", "0.017127423083681547`"}], "}"}],
       ",", 
      RowBox[{"{", 
       RowBox[{"5", ",", "0.8639997002773127`", ",", "0.01814330046062304`"}],
        "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "5", ",", "0.06338050015414287`", ",", "0.0011068984762921778`"}], 
       "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "6", ",", "0.7709238063332833`", ",", "0.014414497904408035`"}], "}"}],
       ",", 
      RowBox[{"{", 
       RowBox[{"6", ",", "0.8515900632136623`", ",", "0.01472614886807017`"}],
        "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "6", ",", "0.09481158276919545`", ",", "0.0013733621602765166`"}], 
       "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "7", ",", "0.7470870073588851`", ",", "0.007065388150420968`"}], "}"}],
       ",", 
      RowBox[{"{", 
       RowBox[{
       "7", ",", "0.8507294235532221`", ",", "0.009047849294238217`"}], "}"}],
       ",", 
      RowBox[{"{", 
       RowBox[{
       "7", ",", "0.1217589678384425`", ",", "0.0015065653322817532`"}], 
       "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "8", ",", "0.6854139531865064`", ",", "0.008051909598544736`"}], "}"}],
       ",", 
      RowBox[{"{", 
       RowBox[{
       "8", ",", "0.8301565637047646`", ",", "0.005593957372360233`"}], "}"}],
       ",", 
      RowBox[{"{", 
       RowBox[{
       "8", ",", "0.17444011588184688`", ",", "0.0028640674587347343`"}], 
       "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"9", ",", "0.653753344437835`", ",", "0.006969817337767208`"}],
        "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "9", ",", "0.8239020556912822`", ",", "0.006609937880885189`"}], "}"}],
       ",", 
      RowBox[{"{", 
       RowBox[{
       "9", ",", "0.20654888873258898`", ",", "0.002172215167084792`"}], 
       "}"}]}], "}"}]}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"QVPIMOVE20R", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"2", ",", "0.781513309867129`", ",", "0.05042746299452272`"}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "0.8072747016482509`", ",", "0.05205695192390475`"}],
        "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "2", ",", "0.03192405594057522`", ",", "0.00015881370886427256`"}], 
       "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "3", ",", "0.7912000772782284`", ",", "0.037852111935391335`"}], "}"}],
       ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "0.819988106512788`", ",", "0.039208391317068714`"}],
        "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "3", ",", "0.03511201735565718`", ",", "0.00011228778897404795`"}], 
       "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "4", ",", "0.7822561356291328`", ",", "0.027697707134372303`"}], "}"}],
       ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "0.8222497832242824`", ",", "0.02903178953071281`"}],
        "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "4", ",", "0.048653286470937876`", ",", "0.00023462953236115568`"}], 
       "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"5", ",", "0.805640638481257`", ",", "0.017738968565971597`"}],
        "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"5", ",", "0.8516062106298792`", ",", "0.01872718288705589`"}],
        "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "5", ",", "0.05397746118316108`", ",", "0.00022858947708643448`"}], 
       "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "6", ",", "0.7851310503285349`", ",", "0.015507101666819867`"}], "}"}],
       ",", 
      RowBox[{"{", 
       RowBox[{"6", ",", "0.8490924281010674`", ",", "0.01674674741136653`"}],
        "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "6", ",", "0.07532982571006837`", ",", "0.000243037267042417`"}], 
       "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "7", ",", "0.7717715479438538`", ",", "0.008933800937173702`"}], "}"}],
       ",", 
      RowBox[{"{", 
       RowBox[{"7", ",", "0.8419881446006876`", ",", "0.00970857177618162`"}],
        "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "7", ",", "0.08339510986576296`", ",", "0.0003059158178493319`"}], 
       "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "8", ",", "0.7437663483113842`", ",", "0.005731691880511981`"}], "}"}],
       ",", 
      RowBox[{"{", 
       RowBox[{
       "8", ",", "0.8372676264374175`", ",", "0.006220588526722093`"}], "}"}],
       ",", 
      RowBox[{"{", 
       RowBox[{
       "8", ",", "0.11168135749514851`", ",", "0.0003269708526542097`"}], 
       "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "9", ",", "0.7328529267836922`", ",", "0.0053274682786720136`"}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "9", ",", "0.8342205394012515`", ",", "0.006151721532806994`"}], "}"}],
       ",", 
      RowBox[{"{", 
       RowBox[{
       "9", ",", "0.12150730351332957`", ",", "0.0003567770282635105`"}], 
       "}"}]}], "}"}]}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.905481536684126*^9, 3.9054815516228857`*^9}, {
   3.90548230519281*^9, 3.90548232620833*^9}, 
   3.9055052315599318`*^9},ExpressionUUID->"9437b68d-025c-4a6a-b982-\
a1e48241745f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", "0.7497894446557202`", ",", "0.040900237686948795`"}],
       "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "0.7748088184446974`", ",", "0.04224430789597803`"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "2", ",", "0.03229498238232069`", ",", "0.0001568107871246263`"}], 
      "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"3", ",", "0.7883312438105672`", ",", "0.044824709916473145`"}],
       "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "0.8179387927383368`", ",", "0.046434276640043924`"}],
       "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "3", ",", "0.0362111299176954`", ",", "0.0003146829397978184`"}], 
      "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"4", ",", "0.7973411690874215`", ",", "0.02074358605483594`"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "0.8408507847387993`", ",", "0.021577901194209596`"}],
       "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "4", ",", "0.05178097641564796`", ",", "0.0006746538540492897`"}], 
      "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"5", ",", "0.8114137037554198`", ",", "0.01651510509998375`"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"5", ",", "0.8676825517167259`", ",", "0.017930544676435022`"}],
       "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "5", ",", "0.06481247136293007`", ",", "0.0009918413277548769`"}], 
      "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"6", ",", "0.7552337108289338`", ",", "0.01114025791153928`"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"6", ",", "0.8354620215084086`", ",", "0.01153100369216279`"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "6", ",", "0.09606588018243031`", ",", "0.001283292159401803`"}], 
      "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"7", ",", "0.7415758311986166`", ",", "0.013402271181373491`"}],
       "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"7", ",", "0.8423639415958771`", ",", "0.013705126692502236`"}],
       "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "7", ",", "0.11971793910862208`", ",", "0.0023738436552523277`"}], 
      "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"8", ",", "0.6861641645338346`", ",", "0.007945993856312781`"}],
       "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"8", ",", "0.8276648957145853`", ",", "0.006879889688199231`"}],
       "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "8", ",", "0.17101826264216083`", ",", "0.0024004100767844243`"}], 
      "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "9", ",", "0.6466671930146732`", ",", "0.0059933433733323415`"}], "}"}],
      ",", 
     RowBox[{"{", 
      RowBox[{"9", ",", "0.8176766663182915`", ",", "0.004907487233291889`"}],
       "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "9", ",", "0.20916657397901703`", ",", "0.0023452117041590516`"}], 
      "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.905482334384059*^9},
 CellLabel->"Out[50]=",ExpressionUUID->"53888c3a-cea5-4508-914e-f09911cae542"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", "0.781513309867129`", ",", "0.05042746299452272`"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "0.8072747016482509`", ",", "0.05205695192390475`"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "2", ",", "0.03192405594057522`", ",", "0.00015881370886427256`"}], 
      "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"3", ",", "0.7912000772782284`", ",", "0.037852111935391335`"}],
       "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "0.819988106512788`", ",", "0.039208391317068714`"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "3", ",", "0.03511201735565718`", ",", "0.00011228778897404795`"}], 
      "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"4", ",", "0.7822561356291328`", ",", "0.027697707134372303`"}],
       "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "0.8222497832242824`", ",", "0.02903178953071281`"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "4", ",", "0.048653286470937876`", ",", "0.00023462953236115568`"}], 
      "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"5", ",", "0.805640638481257`", ",", "0.017738968565971597`"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"5", ",", "0.8516062106298792`", ",", "0.01872718288705589`"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "5", ",", "0.05397746118316108`", ",", "0.00022858947708643448`"}], 
      "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"6", ",", "0.7851310503285349`", ",", "0.015507101666819867`"}],
       "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"6", ",", "0.8490924281010674`", ",", "0.01674674741136653`"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "6", ",", "0.07532982571006837`", ",", "0.000243037267042417`"}], 
      "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"7", ",", "0.7717715479438538`", ",", "0.008933800937173702`"}],
       "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"7", ",", "0.8419881446006876`", ",", "0.00970857177618162`"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "7", ",", "0.08339510986576296`", ",", "0.0003059158178493319`"}], 
      "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"8", ",", "0.7437663483113842`", ",", "0.005731691880511981`"}],
       "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"8", ",", "0.8372676264374175`", ",", "0.006220588526722093`"}],
       "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "8", ",", "0.11168135749514851`", ",", "0.0003269708526542097`"}], 
      "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "9", ",", "0.7328529267836922`", ",", "0.0053274682786720136`"}], "}"}],
      ",", 
     RowBox[{"{", 
      RowBox[{"9", ",", "0.8342205394012515`", ",", "0.006151721532806994`"}],
       "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "9", ",", "0.12150730351332957`", ",", "0.0003567770282635105`"}], 
      "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.9054823343947372`*^9},
 CellLabel->"Out[51]=",ExpressionUUID->"9bdd992a-0269-4c77-a489-855444dd1b23"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"ListLinePlot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"QVPISWAP20R", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{"QVPIMOVE20R", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", "Thresh", ",", 
     "IdealHOP"}], "}"}], ",", 
   RowBox[{"AxesLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"HoldForm", "[", 
       RowBox[{"Layer", " ", "Depth"}], "]"}], ",", 
      RowBox[{"HoldForm", "[", 
       RowBox[{
       "Heavy", " ", "Output", " ", "Generation", " ", "Probability"}], 
       "]"}]}], "}"}]}], ",", 
   RowBox[{"Frame", "->", "True"}], ",", 
   RowBox[{"FrameLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
     "\"\<Size of Square Circuit\>\"", ",", 
      "\"\<Heavy Output Generation Probability\>\""}], "}"}]}], ",", 
   RowBox[{"PlotLegends", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
     "\"\<ARP A2A\>\"", ",", "\"\<ARP SWAP\>\"", ",", "\"\<ARP Move\>\"", 
      ",", "\"\<\!\(\*FractionBox[\(2\), \(3\)]\) Threshold\>\"", ",", 
      "\"\<Ideal HOP\>\""}], "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.905482088496485*^9, 3.9054821202521725`*^9}, {
  3.905482178700098*^9, 
  3.905482207836934*^9}},ExpressionUUID->"124bcdab-1cff-44b7-8760-\
60a82cd0bad1"]
},
WindowSize->{1141.2, 574.8},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
TaggingRules->Association["TryRealOnly" -> False],
Magnification:>1.3 Inherited,
FrontEndVersion->"12.3 for Microsoft Windows (64-bit) (July 9, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"b2873ffc-2c36-4f19-a50c-0f4886811853"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 506, 13, 87, "Input",ExpressionUUID->"d855bdca-4d56-40ea-ba6d-4b252baa9a80"],
Cell[1089, 37, 434, 10, 36, "Message",ExpressionUUID->"7f629585-a68e-4c55-905e-4bd8e874869b"]
}, Open  ]],
Cell[1538, 50, 352, 8, 36, "Input",ExpressionUUID->"6e9f0a85-272e-40a5-b8b8-a870c25583b0"],
Cell[1893, 60, 279, 8, 36, "Input",ExpressionUUID->"5027551a-3088-4742-a531-8d292fa4f707"],
Cell[2175, 70, 1319, 38, 161, "Input",ExpressionUUID->"49b247da-0332-4103-8a0e-d3bf988c86fa"],
Cell[CellGroupData[{
Cell[3519, 112, 18584, 416, 2995, "Input",ExpressionUUID->"3137d4a1-e69b-4fa3-ab75-76524c925fdc"],
Cell[22106, 530, 550, 8, 41, "Output",ExpressionUUID->"9877a295-5faf-48cd-80a1-e1c1621c6274"],
Cell[22659, 540, 3515, 97, 241, "Output",ExpressionUUID->"0f0bfcc0-bdf2-4c3b-85b5-cbf10afe6c90"]
}, Open  ]],
Cell[26189, 640, 39975, 822, 3146, "Input",ExpressionUUID->"5e0f2115-4154-4f33-bc96-b5692730e154"],
Cell[66167, 1464, 29638, 681, 3146, "Input",ExpressionUUID->"dab07584-1db1-4a5b-af72-70e2eb81442c"],
Cell[CellGroupData[{
Cell[95830, 2149, 7447, 196, 705, "Input",ExpressionUUID->"c9c94bdf-c028-4e0f-9d9e-0a5c768ec1c1"],
Cell[103280, 2347, 492, 10, 41, "Output",ExpressionUUID->"6989417d-0b47-44e6-8113-31eff9ca8ede"],
Cell[103775, 2359, 437, 8, 41, "Output",ExpressionUUID->"35ae9f65-b1c5-43c1-a1c2-c7c810af4f98"],
Cell[104215, 2369, 480, 10, 61, "Output",ExpressionUUID->"be6113c4-adb3-44ed-bfd8-2d291b349879"]
}, Open  ]],
Cell[104710, 2382, 6972, 174, 557, "Input",ExpressionUUID->"290df099-ece3-4b61-bb6b-ece1925cb0e8"],
Cell[CellGroupData[{
Cell[111707, 2560, 41343, 1035, 3255, "Input",ExpressionUUID->"160f339b-1ccf-4ffa-b529-a53ed265e97a"],
Cell[153053, 3597, 542, 8, 41, "Output",ExpressionUUID->"9b4f7bf4-cd85-403c-9eb7-06e715af0e5d"],
Cell[153598, 3607, 615, 10, 41, "Output",ExpressionUUID->"b337576f-be84-435d-a207-1e10b8fbb786"]
}, Open  ]],
Cell[154228, 3620, 17922, 451, 1434, "Input",ExpressionUUID->"d0bd97a7-802b-4922-b5a6-236210d0ea0e"],
Cell[172153, 4073, 1343, 24, 36, "Input",ExpressionUUID->"8f5bd6d7-e061-4ee3-ac90-075487e82e1a"],
Cell[173499, 4099, 7828, 176, 779, "Input",ExpressionUUID->"a3d6ca76-f896-4cb9-a40b-833b8a467bde"],
Cell[181330, 4277, 11110, 244, 1076, "Input",ExpressionUUID->"12f1ca1b-be95-44a2-b5ab-ff7b7b163c8a"],
Cell[192443, 4523, 7192, 176, 628, "Input",ExpressionUUID->"a863265f-b3ef-485c-854e-57df0f3c1f64"],
Cell[CellGroupData[{
Cell[199660, 4703, 2321, 45, 186, "Input",ExpressionUUID->"627908bd-c7b1-4324-90be-beb20db519cd"],
Cell[CellGroupData[{
Cell[202006, 4752, 1346, 22, 29, "Print",ExpressionUUID->"407667ce-42ed-4919-9e0b-74e0d5008d68"],
Cell[203355, 4776, 1347, 22, 29, "Print",ExpressionUUID->"9d01cf59-f3db-4512-a9e3-af40395f71dc"]
}, Open  ]],
Cell[204717, 4801, 1017, 30, 73, "Output",ExpressionUUID->"f15479b3-5dc3-42bb-9067-0ec13c1d47c9"]
}, Open  ]],
Cell[205749, 4834, 1035, 30, 136, InheritFromParent,ExpressionUUID->"f1fd7ef4-5a31-4399-a7ac-e0b9dab38da1"],
Cell[206787, 4866, 1813, 55, 210, InheritFromParent,ExpressionUUID->"3594fef4-6189-4e3f-876a-02d78b3aca8d"],
Cell[208603, 4923, 2633, 79, 309, InheritFromParent,ExpressionUUID->"d4bc52f4-b034-405b-9218-cdf45afd8b7b"],
Cell[CellGroupData[{
Cell[211261, 5006, 2742, 82, 334, InheritFromParent,ExpressionUUID->"1bed2382-97a7-42d3-9f50-23dbc15fe081"],
Cell[214006, 5090, 1378, 41, 92, "Output",ExpressionUUID->"bff94974-4590-4e96-ad5b-266ae5eb6e4e"],
Cell[215387, 5133, 1379, 41, 92, "Output",ExpressionUUID->"32a5112f-8d83-4d81-8686-10823d625fa6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[216803, 5179, 251, 5, 36, "Input",ExpressionUUID->"c188c145-d73d-4875-83da-231edfd9969d"],
Cell[217057, 5186, 10168, 257, 172, "Output",ExpressionUUID->"61a9a801-f31c-4498-acad-1e2149c837f9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[227262, 5448, 485, 11, 54, "Input",ExpressionUUID->"33e1a8fa-925e-40a6-ac33-6e2cdf8c62e0"],
Cell[227750, 5461, 690, 18, 57, "Output",ExpressionUUID->"fd7d670d-a27b-452d-9648-65b38fc8e290"]
}, Open  ]],
Cell[228455, 5482, 4816, 83, 210, "Input",ExpressionUUID->"7a548349-74fa-4c9a-8079-eadf4b6f3eb8"],
Cell[CellGroupData[{
Cell[233296, 5569, 7106, 219, 853, "Input",ExpressionUUID->"9437b68d-025c-4a6a-b982-a1e48241745f"],
Cell[240405, 5790, 3390, 101, 216, "Output",ExpressionUUID->"53888c3a-cea5-4508-914e-f09911cae542"],
Cell[243798, 5893, 3394, 101, 216, "Output",ExpressionUUID->"9bdd992a-0269-4c77-a489-855444dd1b23"]
}, Open  ]],
Cell[247207, 5997, 1330, 36, 145, "Input",ExpressionUUID->"124bcdab-1cff-44b7-8760-60a82cd0bad1"]
}
]
*)

